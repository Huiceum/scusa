<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monster Shooting Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background-color: #121212;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            padding: 20px;
        }
        
        .game-container {
            width: 100%;
            max-width: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .game-title {
            font-size: 2rem;
            margin-bottom: 10px;
            color: #494e7d;
            text-shadow: 0 0 10px rgba(255, 87, 34, 0.7);
        }
        
        .game-board {
            width: 100%;
            aspect-ratio: 4/5;
            display: grid;
            grid-template-rows: repeat(5, 1fr);
            gap: 10px;
            background-color: #1e1e1e;
            padding: 10px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        
        .row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            width: 100%;
            height: 100%;
        }
        
        .cell {
            background-color: #2a2a2a;
            border-radius: 5px;
            position: relative;
            transition: background-color 0.1s;
        }
        
        .monster {
    width: 80%;
    height: 80%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
        
        .controls {
            display: flex;
            width: 100%;
            justify-content: space-around;
            margin-top: 10px;
        }
        
        .key {
            width: 60px;
            height: 60px;
            background-color: #333;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            cursor: pointer;
            user-select: none;
            box-shadow: 0 4px 0 #222;
            transition: all 0.1s;
        }
        
        .key:active, .key.active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #222;
            background-color: #555;
        }
        
        .game-menu {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    max-width: 400px;
    background-color: rgba(30, 30, 30, 0.95);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
    z-index: 1000; /* 確保在最上層 */
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.mode-selection {
    display: flex;
    justify-content: space-between;
    gap: 10px;
}

.mode-selection button {
    flex: 1;
}

.game-menu h2 {
    text-align: center;
    margin-bottom: 15px;
    color: #494e7d;
}
        
        .mode-selection {
            display: flex;
            justify-content: space-between;
        }
        
        button {
            padding: 10px 15px;
            background-color: #494e7d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
        }
        
        button:hover {
            background-color: #2c2e44;
        }
        
        button:active {
            transform: scale(0.95);
        }
        
        .game-stats {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 10px;
        }
        
        .timer, .score {
            font-size: 1.2rem;
            background-color: #333;
            padding: 10px;
            border-radius: 5px;
            min-width: 120px;
            text-align: center;
        }
        
        .high-scores {
            margin-top: 20px;
            width: 100%;
            text-align: center;
        }
        
        .high-scores h3 {
            margin-bottom: 10px;
            color: #494e7d;
        }
        
        .records {
            display: flex;
            justify-content: space-around;
        }
        
        .record {
            background-color: #333;
            padding: 10px;
            border-radius: 5px;
            min-width: 120px;
        }
        
        @media (max-width: 768px) {
            .desktop-controls {
                display: none;
            }
        }



.help-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    background-color: #333;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    font-weight: bold;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
    z-index: 100;
}

.help-modal {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80%;
    max-width: 400px;
    background-color: rgba(30, 30, 30, 0.95);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
    z-index: 1001;
    color: white;
}

.help-modal h3 {
    color: #494e7d;
    margin-bottom: 15px;
    text-align: center;
}

.help-modal p {
    margin-bottom: 10px;
}

.help-modal button {
    margin-top: 15px;
    width: 100%;
}
    </style>
</head>
<body>




    <div class="game-container">      
        
        <div class="help-button">?</div>


<div class="help-modal">
    <h3>如何遊玩</h3>
    <p>1. 選擇遊戲模式：限時模式或打擊模式</p>
    <p>2. 點擊「開始遊戲」按鈕開始遊戲</p>
    <p>3. 電腦用戶：使用鍵盤的 A、S、D、F 鍵擊打最底部的怪物</p>
    <p>4. 手機用戶：直接點擊最底部的怪物</p>
    <p>5. 正確擊中怪物得分，錯誤點擊會有懲罰</p>
    <button id="close-help">了解了</button>
</div>
        <h1 class="game-title">Monster Shooting Game</h1>
        
        <div class="game-menu">

            
            <h2>很抱歉，訂單已經截止</h2>
            <p style="text-align: center; margin-bottom: 15px;">您可以玩玩我們的小遊戲，選擇遊戲模式開始遊戲</p>
            <div class="mode-selection">
                <button id="time-mode">限時模式 (30秒)</button>
                <button id="target-mode">打擊模式 (100個)</button>
            </div>
            <button id="start-game">開始遊戲</button>
        </div>
        
        <div class="game-stats">
            <div class="timer">時間: 0s</div>
            <div class="score">得分: 0</div>
        </div>
        
        <div class="game-board">
            <div class="row" data-row="0">
                <div class="cell" data-col="0"></div>
                <div class="cell" data-col="1"></div>
                <div class="cell" data-col="2"></div>
                <div class="cell" data-col="3"></div>
            </div>
            <div class="row" data-row="1">
                <div class="cell" data-col="0"></div>
                <div class="cell" data-col="1"></div>
                <div class="cell" data-col="2"></div>
                <div class="cell" data-col="3"></div>
            </div>
            <div class="row" data-row="2">
                <div class="cell" data-col="0"></div>
                <div class="cell" data-col="1"></div>
                <div class="cell" data-col="2"></div>
                <div class="cell" data-col="3"></div>
            </div>
            <div class="row" data-row="3">
                <div class="cell" data-col="0"></div>
                <div class="cell" data-col="1"></div>
                <div class="cell" data-col="2"></div>
                <div class="cell" data-col="3"></div>
            </div>
            <div class="row" data-row="4">
                <div class="cell" data-col="0"></div>
                <div class="cell" data-col="1"></div>
                <div class="cell" data-col="2"></div>
                <div class="cell" data-col="3"></div>
            </div>
        </div>
        
        <div class="controls desktop-controls">
            <div class="key" data-key="a">A</div>
            <div class="key" data-key="s">S</div>
            <div class="key" data-key="d">D</div>
            <div class="key" data-key="f">F</div>
        </div>
        
        <div class="high-scores">
            <h3>最高紀錄</h3>
            <div class="records">
                <div class="record" id="time-record">限時模式: 0</div>
                <div class="record" id="target-record">打擊模式: 0s</div>
            </div>
        </div>
    </div>
    <!-- 在head標籤中加入，來預加載圖片和音效 -->

    <script>

    // 預加載圖片和音效
    function preloadAssets() {
        // 預加載圖片
        const images = ['ball7.gif', 'ball8.gif', 'ball6.gif'];
        images.forEach(img => {
            const image = new Image();
            image.src = img;
        });
        
        // 預加載音效
        const sounds = ['select01.mp3', 'select02.mp3', 'select03.mp3', 'select04.mp3', 'select08.mp3'];
        sounds.forEach(sound => {
            const audio = new Audio(sound);
            // 設置為不自動播放，只預加載
            audio.preload = 'auto';
        });
    }
    
    // 頁面加載時預加載資源
    window.addEventListener('load', preloadAssets);

    function playSound(type) {
    let soundFile;
    
    if (type === 'correct') {
        // 隨機選擇正確音效
        const correctSounds = ['select01.mp3', 'select02.mp3', 'select03.mp3', 'select04.mp3'];
        soundFile = correctSounds[Math.floor(Math.random() * correctSounds.length)];
    } else if (type === 'wrong') {
        // 錯誤音效
        soundFile = 'select08.mp3';
    }
    
    if (soundFile) {
        const audio = new Audio(soundFile);
        audio.play();
    }
}



        // 遊戲變數
        let gameActive = false;
        let gameMode = null; // 'time' 或 'target'
        let score = 0;
        let time = 0;
        let timer = null;
        let monsters = [];
        let penaltyActive = false;
        
        // DOM 元素
        const gameBoard = document.querySelector('.game-board');
        const rows = document.querySelectorAll('.row');
        const cells = document.querySelectorAll('.cell');
        const keys = document.querySelectorAll('.key');
        const timeModeBtn = document.getElementById('time-mode');
        const targetModeBtn = document.getElementById('target-mode');
        const startGameBtn = document.getElementById('start-game');
        const timerDisplay = document.querySelector('.timer');
        const scoreDisplay = document.querySelector('.score');
        const timeRecordDisplay = document.getElementById('time-record');
        const targetRecordDisplay = document.getElementById('target-record');
        
        // 初始化高分紀錄
        let timeHighScore = localStorage.getItem('timeHighScore') || 0;
        let targetHighScore = localStorage.getItem('targetHighScore') || Infinity;
        
        timeRecordDisplay.textContent = `限時模式: ${timeHighScore}`;
        targetRecordDisplay.textContent = `打擊模式: ${targetHighScore === Infinity ? '0s' : targetHighScore + 's'}`;
        
        // 檢查設備類型
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        const controls = document.querySelector('.desktop-controls');
        if (isMobile) {
            controls.style.display = 'none';
        }
        
        // 遊戲模式選擇
        timeModeBtn.addEventListener('click', () => {
            gameMode = 'time';
            timeModeBtn.style.backgroundColor = '#2c2e44';
            targetModeBtn.style.backgroundColor = '#494e7d';
        });
        
        targetModeBtn.addEventListener('click', () => {
            gameMode = 'target';
            targetModeBtn.style.backgroundColor = '#2c2e44';
            timeModeBtn.style.backgroundColor = '#494e7d';
        });
        
// 開始遊戲
startGameBtn.addEventListener('click', () => {
    if (!gameMode) {
        alert('請先選擇遊戲模式！');
        return;
    }
    
    if (gameActive) return;
    
    resetGame();
    gameActive = true;
    
    // 隱藏選單
    document.querySelector('.game-menu').style.display = 'none';
    
    // 初始化遊戲版面
    initializeBoard();
    
    // 開始計時
    timer = setInterval(() => {
        time += 0.1;
        timerDisplay.textContent = `時間: ${time.toFixed(1)}s`;
        
        if (gameMode === 'time' && time >= 30) {
            endGame();
        }
    }, 100);
});

// 結束遊戲
function endGame() {
    gameActive = false;
    clearInterval(timer);
    
    // 重新顯示選單
    document.querySelector('.game-menu').style.display = 'flex';
    
    // 更新高分
    if (gameMode === 'time') {
        if (score > timeHighScore) {
            timeHighScore = score;
            localStorage.setItem('timeHighScore', timeHighScore);
            timeRecordDisplay.textContent = `限時模式: ${timeHighScore}`;
        }
        alert(`遊戲結束！你在30秒內擊中了 ${score} 個怪物！`);
    } else {
        if (time < targetHighScore || targetHighScore === Infinity) {
            targetHighScore = time;
            localStorage.setItem('targetHighScore', targetHighScore);
            targetRecordDisplay.textContent = `打擊模式: ${targetHighScore.toFixed(1)}s`;
        }
        alert(`遊戲結束！你在 ${time.toFixed(1)} 秒內擊中了100個怪物！`);
    }
}
        
        // 鍵盤事件監聽
        document.addEventListener('keydown', (e) => {
            if (!gameActive || penaltyActive) return;
            
            const key = e.key.toLowerCase();
            const keyIndex = ['a', 's', 'd', 'f'].indexOf(key);
            
            if (keyIndex !== -1) {
                handleInput(keyIndex);
                
                // 添加視覺效果
                keys[keyIndex].classList.add('active');
                setTimeout(() => {
                    keys[keyIndex].classList.remove('active');
                }, 100);
            }
        });
        
        // 螢幕點擊事件監聽（適用於手機）
        gameBoard.addEventListener('click', (e) => {
            if (!gameActive || penaltyActive) return;
            
            const cell = e.target.closest('.cell');
            if (!cell) return;
            
            const col = parseInt(cell.dataset.col);
            const row = parseInt(cell.closest('.row').dataset.row);
            
            // 只有點擊最底部的怪物才有效
            if (row === 4) {
                handleInput(col);
            }
        });
        
        // 點擊按鍵
        keys.forEach((key, index) => {
            key.addEventListener('click', () => {
                if (!gameActive || penaltyActive) return;
                handleInput(index);
            });
        });
        
 // 修改初始化遊戲版面函數
function initializeBoard() {
    // 清空版面
    cells.forEach(cell => {
        while (cell.firstChild) {
            cell.removeChild(cell.firstChild);
        }
    });
    
    monsters = [];
    
    // 為每一列生成一個怪物
    for (let row = 0; row < 5; row++) {
        const randomCol = Math.floor(Math.random() * 4);
        const randomBall = `ball${Math.floor(Math.random() * 3) + 6}.gif`; // ball7.gif, ball8.gif, or ball9.gif
        
        monsters.push({ row, col: randomCol, ballImage: randomBall });
        
        const cell = document.querySelector(`.row[data-row="${row}"] .cell[data-col="${randomCol}"]`);
        const monster = document.createElement('img');
        monster.classList.add('monster');
        monster.src = randomBall;
        cell.appendChild(monster);
    }
}

// 修改處理玩家輸入函數
function handleInput(col) {
    // 檢查最底部的怪物
    const bottomMonster = monsters.find(m => m.row === 4);
    
    if (bottomMonster && bottomMonster.col === col) {
        // 點擊正確
        playSound('correct'); // 播放正確音效
        
        score++;
        scoreDisplay.textContent = `得分: ${score}`;
        
        // 檢查目標模式是否完成
        if (gameMode === 'target' && score >= 100) {
            endGame();
            return;
        }
        
        // 移除底部怪物
        monsters = monsters.filter(m => m.row !== 4);
        
        // 其他怪物下移
        monsters.forEach(monster => {
            monster.row++;
        });
        
        // 新增一個怪物到頂部
        const randomCol = Math.floor(Math.random() * 4);
        const randomBall = `ball${Math.floor(Math.random() * 3) + 6}.gif`; // ball7.gif, ball8.gif, or ball9.gif
        monsters.push({ row: 0, col: randomCol, ballImage: randomBall });
        
        // 更新顯示
        updateMonsters();
    } else {
        // 點擊錯誤
        playSound('wrong'); // 播放錯誤音效
        applyPenalty();
    }
}

// 修改更新怪物顯示函數
function updateMonsters() {
    // 清空版面
    cells.forEach(cell => {
        while (cell.firstChild) {
            cell.removeChild(cell.firstChild);
        }
    });
    
    // 重新繪製怪物
    monsters.forEach(monster => {
        const cell = document.querySelector(`.row[data-row="${monster.row}"] .cell[data-col="${monster.col}"]`);
        const monsterElement = document.createElement('img');
        monsterElement.classList.add('monster');
        monsterElement.src = monster.ballImage;
        cell.appendChild(monsterElement);
    });
}
        // 錯誤懲罰
        function applyPenalty() {
            if (penaltyActive) return;
            
            penaltyActive = true;
            gameBoard.style.opacity = '0.5';
            
            setTimeout(() => {
                penaltyActive = false;
                gameBoard.style.opacity = '1';
            }, 500);
        }
        
        // 結束遊戲
        function endGame() {
            gameActive = false;
            clearInterval(timer);
            
            startGameBtn.textContent = '開始遊戲';
            
            // 更新高分
            if (gameMode === 'time') {
                if (score > timeHighScore) {
                    timeHighScore = score;
                    localStorage.setItem('timeHighScore', timeHighScore);
                    timeRecordDisplay.textContent = `限時模式: ${timeHighScore}`;
                }
                alert(`遊戲結束！你在30秒內擊中了 ${score} 個怪物！`);
            } else {
                if (time < targetHighScore || targetHighScore === Infinity) {
                    targetHighScore = time;
                    localStorage.setItem('targetHighScore', targetHighScore);
                    targetRecordDisplay.textContent = `打擊模式: ${targetHighScore.toFixed(1)}s`;
                }
                alert(`遊戲結束！你在 ${time.toFixed(1)} 秒內擊中了100個怪物！`);
            }
        }
        
        // 重置遊戲
        function resetGame() {
            score = 0;
            time = 0;
            monsters = [];
            penaltyActive = false;
            
            scoreDisplay.textContent = `得分: ${score}`;
            timerDisplay.textContent = `時間: ${time.toFixed(1)}s`;
            
            gameBoard.style.opacity = '1';
            
            clearInterval(timer);
        }

// 在 <script> 中添加以下 JavaScript
// 添加幫助按鈕功能
document.querySelector('.help-button').addEventListener('click', () => {
    document.querySelector('.help-modal').style.display = 'block';
});

// 添加關閉幫助的功能
document.getElementById('close-help').addEventListener('click', () => {
    document.querySelector('.help-modal').style.display = 'none';
});
    </script>
</body>
</html>