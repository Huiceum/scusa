<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>行事曆 - 東吳大學學生會</title>
    <link rel="stylesheet" href="style.css">
    <style>


        .calendar-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
        }

        .month-button {
            background-color: #232323;
            color: #f0f0f0;
            padding: 15px;
            margin: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.3s;
        }

        .month-button:hover {
            transform: scale(1.05);
            background-color: #181818;
        }

        .content {
            display: none; /* 隱藏內容 */
            margin-top: 20px;
            border: 1px solid #696969;
            padding: 15px;
            background-color: #232323;
            border-radius: 5px;
        }
    </style>
</head>
<body>

<div class="calendar-container">
    <!-- 12個月份按鈕 -->
    <button class="month-button" data-month="1">一月</button>
    <button class="month-button" data-month="2">二月</button>
    <button class="month-button" data-month="3">三月</button>
    <button class="month-button" data-month="4">四月</button>
    <button class="month-button" data-month="5">五月</button>
    <button class="month-button" data-month="6">六月</button>
    <button class="month-button" data-month="7">七月</button>
    <button class="month-button" data-month="8">八月</button>
    <button class="month-button" data-month="9">九月</button>
    <button class="month-button" data-month="10">十月</button>
    <button class="month-button" data-month="11">十一月</button>
    <button class="month-button" data-month="12">十二月</button>
</div>

<div id="content-container">
    <!-- 每個月份的內容將自動載入 -->
</div>

<script>
    document.querySelectorAll('.month-button').forEach(button => {
        button.addEventListener('click', function() {
            const month = this.getAttribute('data-month');
            loadMonthContent(month);
        });
    });

    function loadMonthContent(month) {
        const sheetId = '1AnQToxmU1SYFFzGZ-3Ag8T4RUmmOXJFCEKY-zDR0K2s'; // 你的試算表 ID
        const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv`;

        fetch(url)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.text();
            })
            .then(data => {
                const rows = data.split('\n').slice(1); // 移除標題行
                const contentContainer = document.getElementById('content-container');
                contentContainer.innerHTML = ''; // 清空現有內容

                // 過濾出對應月份的行
                rows.forEach(row => {
                    const columns = row.split(',').map(col => col.replace(/"/g, '').trim());
                    if (columns[0] === month) { // 假設第一列是月份
                        const contentDiv = document.createElement('div');
                        contentDiv.classList.add('content');
                        contentDiv.innerHTML = `
                            <p>${columns[1]}</p>   <!-- 假設第二列是內容 -->
                        `;
                        contentContainer.appendChild(contentDiv);
                    }
                });

                // 顯示所有活動內容
                const contents = contentContainer.getElementsByClassName('content');
                for (let i = 0; i < contents.length; i++) {
                    contents[i].style.display = 'block'; // 顯示所有活動
                }
            })
            .catch(error => {
                console.error('Error loading month content:', error);
                alert('無法載入內容，請查看控制台獲取更多資訊。');
            });
    }
</script>

</body>
</html>
