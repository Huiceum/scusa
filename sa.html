<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>首頁 - 東吳大學學生會</title>
    <link rel="stylesheet" href="sa.css">

    <link rel="icon" href="favicon.PNG" type="image/x-icon">
    <style>
.icon-section {
    background-color: #211a35; /* 設置背景顏色 */
    padding: 20px;
    margin-top: 50px; /* 與上方的區塊保持間隔 */
}

.icon-container {
    display: flex;
    flex-wrap: wrap; /* 允許換行 */
    justify-content: center; /* 內容置中 */
}

.icon {
    width: calc(33.33% - 70px); /* 每個圖示佔據三分之一的寬度，減去邊距 */
    height: auto; /* 圖示的高度 */
    margin: 30px; /* 圖示之間的間隔，調整到更合理的值 */
    position: relative; /* 相對定位以放置超連結 */
    overflow: hidden; /* 隱藏溢出的部分 */
    transition: transform 0.3s; /* 放大效果的過渡 */
}

.icon img {
    width: 100%; /* 圖示的圖片寬度 */
    height: auto; /* 圖示的圖片高度 */
    border-radius: 10px; /* 圖示圓角 */
}

.icon:hover {
    transform: scale(1.08) rotate(5deg); /* 滑鼠懸停時放大並輕微旋轉 */
}

.icon-text {
    text-align: center; /* 文字置中 */
    color: #fff; /* 文字顏色 */
    margin-top: 5px; /* 文字與圖示的間距 */
    font-size: 24px;
    font-weight: bold;
}

/* 媒體查詢：當螢幕寬度小於 768px 時（手機模式） */
@media screen and (max-width: 768px) {
    .icon {
        width: 60%; /* 在手機上每個圖示佔據一整行 */
        margin: 15px 0; /* 上下間距調整，左右不需要 */
    }
    
    .icon-text {
        font-size: 20px; /* 手機上文字稍微縮小 */
    }
}

/* 中等螢幕尺寸，可以選擇設定為兩個一排 */
@media screen and (min-width: 769px) and (max-width: 1024px) {
    .icon {
        width: calc(50% - 20px); /* 兩個一排 */
    }
}


.calendar-container {
            width: 70%;
            margin: 20px auto;
            border: 1px solid #000000;
            background-color: #ccccff;
            position: relative;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background-color: #3f51b5;
            color: white;
            cursor: pointer;
        }

        .calendar-header span {
            font-size: 16px;
        }

        .calendar-header .arrow {
            font-size: 20px;
            transform: rotate(0deg);
            transition: transform 0.3s;
        }

        .calendar-header .arrow.open {
            transform: rotate(180deg);
        }

        .calendar-content {
            height: 0;
            overflow: hidden;
            transition: height 0.3s ease;
        }

        .calendar-content iframe {
            width: 100%;
            height: 600px;
            border: none;
        }

        .expanded .calendar-content {
            height: 600px;
        }

        .view-more-btn {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #6887ae;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .view-more-btn:hover {
        background-color: rgb(205, 47, 71);
    }

    .updateTime {
        bottom: 10px;
        font-size: 0.8em;
        color: #b9b9b9;
        
    }
        /*oooooooooooooooooooooooooooooo*/
   .image-container {
            position: relative;
            width: 110%; /* 使容器寬度自適應 */
            aspect-ratio: 3 / 1; /* 高度是寬度的三分之一 */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }


        .doc img {
            width: 100%;
            height: auto;
            max-height: 33.33vw; /* 高度為寬度的三分之一 */
            object-fit: contain;
            display: block;
            transition: all 0.7s ease-in-out; /* 動畫效果 */
        }

        .doc {
            position: absolute;
            top: 0;
            left: 100%; /* 初始位置在畫面外 */
            width: 100%;
            height: 100%;
            transform: scale(0.85);
            opacity: 0;
            transition: all 0.7s ease-in-out;
        }

        .doc.active {
            left: 0; /* 當前頁面顯示 */
            opacity: 1;
        }

        .doc.exit-left {
            left: -100%; /* 向左退出 */
            opacity: 0;
        }

        .doc.enter-right {
            left: 100%; /* 從右側進入 */
            opacity: 0;
        }

        .button-container {
            position:relative;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            width: 100%;

        }

        .btn {
            background-color: #ededed;
            color: rgb(21, 21, 21);
            padding: 10px;
            border: none;
            cursor: pointer;
            width: 30%;
        }

        .btn:hover {
            background-color: #b9b9b9;
        }

        /* 新增樣式 */
.announcement-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 10px;
}

.detail-btn {
    background-color: #4a5568;
    color: white;
    border: none;
    border-radius: 5px;
    padding: 5px 15px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.detail-btn:hover {
    background-color: #2d3748;
}

.iframe-container {
    transition: all 0.3s ease;
    overflow: hidden;
}
    </style>
</head>

<body>
    <div class="container">
        <!-- 漢堡選單按鈕 -->
        <div class="hamburger-menu" id="hamburger-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <!-- 手機版側邊欄 -->
        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <img src="logo.png" alt="Logo">
                <div class="site-name"></div>
            </div>
            <ul class="nav-links" id="mobile-nav">
                <!-- 動態加載的導航項目將插入此處 -->
            </ul>
        </nav>

        <div class="main-content">
            <!-- 桌面版導航欄 -->
            <div class="navbar">
                <ul class="nav-options" id="nav-container">
                    <!-- 動態加載的導航項目將插入此處 -->
                </ul>


            </div>

            <div class="image-container">
                <!-- 顯示圖片的容器 -->
        
            
            </div>
            
            <div class="button-container">
                <button id="prev-btn" class="btn">上一頁</button>
                <button id="next-btn" class="btn">下一頁</button>
            </div>


            <div class="announcements slide-up">
                <div id="announcements-list">
                    <!-- 公告內容將自動載入 -->
                </div>
                <button id="view-more" class="view-more-btn">查看更多</button>
            </div>
                <!-- 更新時間將顯示在這裡 -->
            </div>


            <div class="icon-section">

                <div class="calendar-container">
                    <div class="calendar-header" onclick="toggleCalendar()">
                        <span>顯示 Google 日曆</span>
                        <span class="arrow">▼</span>
                    </div>
                    <div class="calendar-content">
                        <iframe src="https://calendar.google.com/calendar/embed?src=scusa000%40gmail.com&ctz=Asia%2FTaipei"scrolling="no"></iframe>
                    </div>
                </div>

                    <h2 style="text-align: center;">活動專區</h2>
                <div class="icon-container slide-up">
                    <!-- 這裡將會動態加載圖片、文字和超連結 -->
                </div>


            <!-- 浮動球 -->
            <div id="ball-container">
                <img id="ball" src="ball7.gif" alt="Ball">
            </div>

            <div class="footer">
                <div class="footer-content">
                    <ul class="footer-links" id="footer-links">
                        <!-- 動態加載的底部鏈接將插入此處 -->
                    </ul>
                    <div class="footer-info">
                        © 2025 東吳大學學生會 版權所有
                    </div>
                </div>
            </div>
        </div>
 
    </div>



    <!-- JavaScript -->
    <script src="sa.js"></script>
    <script src="sa0.js"></script>

    <script>
        ////////////////////////////////////////
        document.addEventListener('DOMContentLoaded', function() {
            doctrans(); // 載入圖片
        });

        let currentIndex = 0; // 當前顯示的頁面索引
        let docs = []; // 儲存所有圖片元素

        // 載入試算表的資料
        fetch('/.netlify/functions/fetchSheet?sheet=sa_sheet_av')
            .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
            .then(data => {
                const rows = data.split('\n').slice(1); // 分割行並移除標題行
                const imageContainer = document.querySelector('.image-container');
                imageContainer.innerHTML = ''; // 清空圖片區域

                rows.forEach(row => {
                    const [imageUrl, link] = row.split(',').map(col => col.replace(/"/g, '').trim()); // 解析每一行

                    if (imageUrl && link) {
                        const doc = document.createElement('div');
                        doc.classList.add('doc');
                        doc.innerHTML = `
                            <a href="${link}" target="_blank">
                                <img src="${imageUrl}" alt="Image">
                            </a>
                        `;
                        imageContainer.appendChild(doc);
                        docs.push(doc); // 將每張圖片存入 docs
                    }
                });

                showDoc(currentIndex); // 初始化顯示
            })
            .catch(error => console.error('Error loading icons:', error));

        // 顯示當前圖片
        function showDoc(index) {
            docs.forEach((doc, i) => {
                doc.classList.remove('active', 'exit-left', 'enter-right');
                if (i === index) {
                    doc.classList.add('active');
                } else if (i < index) {
                    doc.classList.add('exit-left');
                } else {
                    doc.classList.add('enter-right');
                }
            });
        }

        // 下一頁
        function nextDoc() {
            currentIndex = (currentIndex + 1) % docs.length;
            showDoc(currentIndex);
        }

        // 上一頁
        function prevDoc() {
            currentIndex = (currentIndex - 1 + docs.length) % docs.length;
            showDoc(currentIndex);
        }

        // 自動換頁
        let autoChange = setInterval(nextDoc, 5000); // 每 5 秒自動換頁

        // 按鈕事件綁定
        document.getElementById('next-btn').addEventListener('click', () => {
            clearInterval(autoChange); // 停止自動換頁
            nextDoc();
            autoChange = setInterval(nextDoc, 5000); // 重啟自動換頁
        });

        document.getElementById('prev-btn').addEventListener('click', () => {
            clearInterval(autoChange); // 停止自動換頁
            prevDoc();
            autoChange = setInterval(nextDoc, 5000); // 重啟自動換頁
        });


function toggleCalendar() {
            const container = document.querySelector('.calendar-container');
            const arrow = document.querySelector('.calendar-header .arrow');
            container.classList.toggle('expanded');
            arrow.classList.toggle('open');
        }
        //////////////////////////////////////////////
        document.addEventListener('DOMContentLoaded', function() {
            loadAnnouncements();
            loadIcons(); // 載入公告
        });

        function loadIcons() {

    fetch('/.netlify/functions/fetchSheet?sheet=sa_sheet_aA')
        .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
        .then(data => {
            const rows = data.split('\n').slice(1); // 分割行並移除標題行
            const iconContainer = document.querySelector('.icon-container');
            iconContainer.innerHTML = ''; // 清空圖示區域

            rows.forEach(row => {
                const [imageUrl, text, link] = row.split(',').map(col => col.replace(/"/g, '').trim()); // 解析每一行

                if (imageUrl && text && link) {
                    const icon = document.createElement('div');
                    icon.classList.add('icon');

                    icon.innerHTML = `
                        <a href="${link}" target="_blank">
                            <img src="${imageUrl}" alt="${text}">
                            <div class="icon-text">${text}</div>
                        </a>
                    `;
                    iconContainer.appendChild(icon);
                }
            });
        })
        .catch(error => console.error('Error loading icons:', error));
}

function loadAnnouncements() {

    fetch('/.netlify/functions/fetchSheet?sheet=sa_sheet_aAnn')
    .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
    .then(data => {
        const rows = data.split('\n').slice(1); // 分割行並移除標題行
        const announcementList = document.getElementById('announcements-list');
        announcementList.innerHTML = ''; // 清空公告欄

        // 只顯示前三筆公告
        rows.slice(0, 3).forEach((row, index) => {
            const columns = row.split(',').map(col => col.replace(/"/g, '').trim());
            const newAnnouncement = document.createElement('div');
            newAnnouncement.classList.add('announcement');
            
            // 創建唯一ID用於識別每個公告
            const announcementId = `announcement-${index}`;
            const iframeId = `iframe-${index}`;

            // 提取Google Drive文件ID
            let driveFileId = columns[2];
            // 檢查是否是Google Drive連結，並提取文件ID
            if (driveFileId.includes('drive.google.com')) {
                // 從URL中提取文件ID
                const match = driveFileId.match(/[-\w]{25,}/);
                if (match) {
                    driveFileId = match[0];
                }
            }

            // 假設第一列是標題，第二列是訊息，第三列是超連結
            newAnnouncement.innerHTML = `
                <h2 class="title"><a href="${columns[2]}" class="link" target="_blank">${columns[0]}</a></h2>
                <p class="message">${columns[1]}</p>
                <div class="announcement-footer">
                    <p class="updateTime">發文時間：${columns[3]}</p>
                    <button class="detail-btn" data-file-id="${driveFileId}" data-target="${iframeId}">詳</button>
                </div>
                <div class="iframe-container" id="${iframeId}" style="display: none; width: 100%; margin-top: 10px;"></div>
            `;
            
            announcementList.appendChild(newAnnouncement);
        });
        
        // 為所有"詳"按鈕添加點擊事件
        document.querySelectorAll('.detail-btn').forEach(button => {
            button.addEventListener('click', function() {
    const fileId = this.getAttribute('data-file-id');
    const targetId = this.getAttribute('data-target');
    const container = document.getElementById(targetId);

    // 對應的原始連結
    const originalLink = this.closest('.announcement').querySelector('.link').href;

    // 檢查是否為 Google Drive PDF 分享連結
    const isGoogleDrivePDF = /https:\/\/drive\.google\.com\/.*\/d\/[-\w]{25,}/.test(originalLink) || /https:\/\/drive\.google\.com\/file\/d\/[-\w]{25,}/.test(originalLink);

    if (!isGoogleDrivePDF) {
        window.open(originalLink, '_blank');
        return;
    }

    // 切換iframe的顯示狀態
    if (container.style.display === 'none') {
        container.innerHTML = `<iframe src="https://drive.google.com/file/d/${fileId}/preview" width="100%" height="500px" frameborder="0" allowtransparency="true" allowfullscreen></iframe>`;
        container.style.display = 'block';
    } else {
        container.style.display = 'none';
        container.innerHTML = '';
    }
});

        });
    })
    .catch(error => {
        console.error('Error loading announcements:', error);
        alert('無法載入公告，請查看控制台獲取更多資訊。');
    });
}

    document.getElementById('view-more').addEventListener('click', () => {
        window.location.href = 'saa.html'; // 替換為實際的目標網址
    });

    document.addEventListener('DOMContentLoaded', loadAnnouncements);

        document.addEventListener('DOMContentLoaded', function() {
            const dropdownParent = document.querySelector('.dropdown-parent');
            const dropdownToggle = dropdownParent.querySelector('.dropdown-toggle');
            const dropdownContent = dropdownParent.querySelector('.dropdown-content');
            
            dropdownToggle.addEventListener('click', function() {
                dropdownParent.classList.toggle('active');
            });
        });


        
    </script>


</body>
</html>