<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦–é  - æ±å³å¤§å­¸å­¸ç”Ÿæœƒ</title>
    <link rel="stylesheet" href="sa.css">

    <link rel="icon" href="favicon.PNG" type="image/x-icon">
    <style>
.icon-section {
    background-color: #211a35; /* è¨­ç½®èƒŒæ™¯é¡è‰² */
    padding: 20px;
    margin-top: 50px; /* èˆ‡ä¸Šæ–¹çš„å€å¡Šä¿æŒé–“éš” */
}

.icon-container {
    display: flex;
    flex-wrap: wrap; /* å…è¨±æ›è¡Œ */
    justify-content: center; /* å…§å®¹ç½®ä¸­ */
}

.icon {
    width: calc(33.33% - 70px); /* æ¯å€‹åœ–ç¤ºä½”æ“šä¸‰åˆ†ä¹‹ä¸€çš„å¯¬åº¦ï¼Œæ¸›å»é‚Šè· */
    height: auto; /* åœ–ç¤ºçš„é«˜åº¦ */
    margin: 30px; /* åœ–ç¤ºä¹‹é–“çš„é–“éš”ï¼Œèª¿æ•´åˆ°æ›´åˆç†çš„å€¼ */
    position: relative; /* ç›¸å°å®šä½ä»¥æ”¾ç½®è¶…é€£çµ */
    overflow: hidden; /* éš±è—æº¢å‡ºçš„éƒ¨åˆ† */
    transition: transform 0.3s; /* æ”¾å¤§æ•ˆæœçš„éæ¸¡ */
}

.icon img {
    width: 100%; /* åœ–ç¤ºçš„åœ–ç‰‡å¯¬åº¦ */
    height: auto; /* åœ–ç¤ºçš„åœ–ç‰‡é«˜åº¦ */
    border-radius: 10px; /* åœ–ç¤ºåœ“è§’ */
}

.icon:hover {
    transform: scale(1.08) rotate(5deg); /* æ»‘é¼ æ‡¸åœæ™‚æ”¾å¤§ä¸¦è¼•å¾®æ—‹è½‰ */
}

.icon-text {
    text-align: center; /* æ–‡å­—ç½®ä¸­ */
    color: #fff; /* æ–‡å­—é¡è‰² */
    margin-top: 5px; /* æ–‡å­—èˆ‡åœ–ç¤ºçš„é–“è· */
    font-size: 24px;
    font-weight: bold;
}

/* åª’é«”æŸ¥è©¢ï¼šç•¶è¢å¹•å¯¬åº¦å°æ–¼ 768px æ™‚ï¼ˆæ‰‹æ©Ÿæ¨¡å¼ï¼‰ */
@media screen and (max-width: 768px) {
    .icon {
        width: 60%; /* åœ¨æ‰‹æ©Ÿä¸Šæ¯å€‹åœ–ç¤ºä½”æ“šä¸€æ•´è¡Œ */
        margin: 15px 0; /* ä¸Šä¸‹é–“è·èª¿æ•´ï¼Œå·¦å³ä¸éœ€è¦ */
    }
    
    .icon-text {
        font-size: 20px; /* æ‰‹æ©Ÿä¸Šæ–‡å­—ç¨å¾®ç¸®å° */
    }
}

/* ä¸­ç­‰è¢å¹•å°ºå¯¸ï¼Œå¯ä»¥é¸æ“‡è¨­å®šç‚ºå…©å€‹ä¸€æ’ */
@media screen and (min-width: 769px) and (max-width: 1024px) {
    .icon {
        width: calc(50% - 20px); /* å…©å€‹ä¸€æ’ */
    }
}


.calendar-container {
            width: 70%;
            margin: 20px auto;
            border: 1px solid #000000;
            background-color: #ccccff;
            position: relative;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background-color: #3f51b5;
            color: white;
            cursor: pointer;
        }

        .calendar-header span {
            font-size: 16px;
        }

        .calendar-header .arrow {
            font-size: 20px;
            transform: rotate(0deg);
            transition: transform 0.3s;
        }

        .calendar-header .arrow.open {
            transform: rotate(180deg);
        }

        .calendar-content {
            height: 0;
            overflow: hidden;
            transition: height 0.3s ease;
        }

        .calendar-content iframe {
            width: 100%;
            height: 600px;
            border: none;
        }

        .expanded .calendar-content {
            height: 600px;
        }

        .view-more-btn {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #6887ae;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .view-more-btn:hover {
        background-color: rgb(205, 47, 71);
    }

    .updateTime {
        bottom: 10px;
        font-size: 0.8em;
        color: #b9b9b9;
        
    }
        /*oooooooooooooooooooooooooooooo*/
   .image-container {
            position: relative;
            width: 110%; /* ä½¿å®¹å™¨å¯¬åº¦è‡ªé©æ‡‰ */
            aspect-ratio: 3 / 1; /* é«˜åº¦æ˜¯å¯¬åº¦çš„ä¸‰åˆ†ä¹‹ä¸€ */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }


        .doc img {
            width: 100%;
            height: auto;
            max-height: 33.33vw; /* é«˜åº¦ç‚ºå¯¬åº¦çš„ä¸‰åˆ†ä¹‹ä¸€ */
            object-fit: contain;
            display: block;
            transition: all 0.7s ease-in-out; /* å‹•ç•«æ•ˆæœ */
        }

        .doc {
            position: absolute;
            top: 0;
            left: 100%; /* åˆå§‹ä½ç½®åœ¨ç•«é¢å¤– */
            width: 100%;
            height: 100%;
            transform: scale(0.85);
            opacity: 0;
            transition: all 0.7s ease-in-out;
        }

        .doc.active {
            left: 0; /* ç•¶å‰é é¢é¡¯ç¤º */
            opacity: 1;
        }

        .doc.exit-left {
            left: -100%; /* å‘å·¦é€€å‡º */
            opacity: 0;
        }

        .doc.enter-right {
            left: 100%; /* å¾å³å´é€²å…¥ */
            opacity: 0;
        }

        .button-container {
            position:relative;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            width: 100%;

        }

        .btn {
            background-color: #ededed;
            color: rgb(21, 21, 21);
            padding: 10px;
            border: none;
            cursor: pointer;
            width: 30%;
        }

        .btn:hover {
            background-color: #b9b9b9;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- æ¼¢å ¡é¸å–®æŒ‰éˆ• -->
        <div class="hamburger-menu" id="hamburger-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <!-- æ‰‹æ©Ÿç‰ˆå´é‚Šæ¬„ -->
        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <img src="logo.png" alt="Logo">
                <div class="site-name"></div>
            </div>
            <ul class="nav-links" id="mobile-nav">
                <!-- å‹•æ…‹åŠ è¼‰çš„å°èˆªé …ç›®å°‡æ’å…¥æ­¤è™• -->
            </ul>
        </nav>

        <div class="main-content">
            <!-- æ¡Œé¢ç‰ˆå°èˆªæ¬„ -->
            <div class="navbar">
                <ul class="nav-options" id="nav-container">
                    <!-- å‹•æ…‹åŠ è¼‰çš„å°èˆªé …ç›®å°‡æ’å…¥æ­¤è™• -->
                </ul>


            </div>

            <div class="image-container">
                <!-- é¡¯ç¤ºåœ–ç‰‡çš„å®¹å™¨ -->
        
            
            </div>
            
            <div class="button-container">
                <button id="prev-btn" class="btn">ä¸Šä¸€é </button>
                <button id="next-btn" class="btn">ä¸‹ä¸€é </button>
            </div>


            <div class="announcements slide-up">
                <div id="announcements-list">
                    <!-- å…¬å‘Šå…§å®¹å°‡è‡ªå‹•è¼‰å…¥ -->
                </div>
                <button id="view-more" class="view-more-btn">æŸ¥çœ‹æ›´å¤š</button>
            </div>
                <!-- æ›´æ–°æ™‚é–“å°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
            </div>


            <div class="icon-section">

                <div class="calendar-container">
                    <div class="calendar-header" onclick="toggleCalendar()">
                        <span>é¡¯ç¤º Google æ—¥æ›†</span>
                        <span class="arrow">â–¼</span>
                    </div>
                    <div class="calendar-content">
                        <iframe src="https://calendar.google.com/calendar/embed?src=scusa000%40gmail.com&ctz=Asia%2FTaipei"scrolling="no"></iframe>
                    </div>
                </div>

                    <h2 style="text-align: center;">æ´»å‹•å°ˆå€</h2>
                <div class="icon-container slide-up">
                    <!-- é€™è£¡å°‡æœƒå‹•æ…‹åŠ è¼‰åœ–ç‰‡ã€æ–‡å­—å’Œè¶…é€£çµ -->
                </div>


            <!-- æµ®å‹•çƒ -->
            <div id="ball-container">
                <img id="ball" src="ball7.gif" alt="Ball">
            </div>

            <div class="footer">
                <div class="footer-content">
                    <ul class="footer-links" id="footer-links">
                        <!-- å‹•æ…‹åŠ è¼‰çš„åº•éƒ¨éˆæ¥å°‡æ’å…¥æ­¤è™• -->
                    </ul>
                    <div class="footer-info">
                        Â© 2025 æ±å³å¤§å­¸å­¸ç”Ÿæœƒ ç‰ˆæ¬Šæ‰€æœ‰
                    </div>
                </div>
            </div>
        </div>
 
    </div>



    <!-- JavaScript -->
    <script src="sa.js"></script>
    <script src="sa0.js"></script>

    <script>
        ////////////////////////////////////////
        document.addEventListener('DOMContentLoaded', function() {
            doctrans(); // è¼‰å…¥åœ–ç‰‡
        });

        let currentIndex = 0; // ç•¶å‰é¡¯ç¤ºçš„é é¢ç´¢å¼•
        let docs = []; // å„²å­˜æ‰€æœ‰åœ–ç‰‡å…ƒç´ 
        const sheetId = '117iP2R3W0Ty-YGbIm2nHf5D1nNyjTR-hgCZirJmch0M'; // è©¦ç®—è¡¨ ID
        const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv`;

        // è¼‰å…¥è©¦ç®—è¡¨çš„è³‡æ–™
        fetch(url)
            .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
            .then(data => {
                const rows = data.split('\n').slice(1); // åˆ†å‰²è¡Œä¸¦ç§»é™¤æ¨™é¡Œè¡Œ
                const imageContainer = document.querySelector('.image-container');
                imageContainer.innerHTML = ''; // æ¸…ç©ºåœ–ç‰‡å€åŸŸ

                rows.forEach(row => {
                    const [imageUrl, link] = row.split(',').map(col => col.replace(/"/g, '').trim()); // è§£ææ¯ä¸€è¡Œ

                    if (imageUrl && link) {
                        const doc = document.createElement('div');
                        doc.classList.add('doc');
                        doc.innerHTML = `
                            <a href="${link}" target="_blank">
                                <img src="${imageUrl}" alt="Image">
                            </a>
                        `;
                        imageContainer.appendChild(doc);
                        docs.push(doc); // å°‡æ¯å¼µåœ–ç‰‡å­˜å…¥ docs
                    }
                });

                showDoc(currentIndex); // åˆå§‹åŒ–é¡¯ç¤º
            })
            .catch(error => console.error('Error loading icons:', error));

        // é¡¯ç¤ºç•¶å‰åœ–ç‰‡
        function showDoc(index) {
            docs.forEach((doc, i) => {
                doc.classList.remove('active', 'exit-left', 'enter-right');
                if (i === index) {
                    doc.classList.add('active');
                } else if (i < index) {
                    doc.classList.add('exit-left');
                } else {
                    doc.classList.add('enter-right');
                }
            });
        }

        // ä¸‹ä¸€é 
        function nextDoc() {
            currentIndex = (currentIndex + 1) % docs.length;
            showDoc(currentIndex);
        }

        // ä¸Šä¸€é 
        function prevDoc() {
            currentIndex = (currentIndex - 1 + docs.length) % docs.length;
            showDoc(currentIndex);
        }

        // è‡ªå‹•æ›é 
        let autoChange = setInterval(nextDoc, 5000); // æ¯ 5 ç§’è‡ªå‹•æ›é 

        // æŒ‰éˆ•äº‹ä»¶ç¶å®š
        document.getElementById('next-btn').addEventListener('click', () => {
            clearInterval(autoChange); // åœæ­¢è‡ªå‹•æ›é 
            nextDoc();
            autoChange = setInterval(nextDoc, 5000); // é‡å•Ÿè‡ªå‹•æ›é 
        });

        document.getElementById('prev-btn').addEventListener('click', () => {
            clearInterval(autoChange); // åœæ­¢è‡ªå‹•æ›é 
            prevDoc();
            autoChange = setInterval(nextDoc, 5000); // é‡å•Ÿè‡ªå‹•æ›é 
        });


function toggleCalendar() {
            const container = document.querySelector('.calendar-container');
            const arrow = document.querySelector('.calendar-header .arrow');
            container.classList.toggle('expanded');
            arrow.classList.toggle('open');
        }
        //////////////////////////////////////////////
        document.addEventListener('DOMContentLoaded', function() {
            loadAnnouncements();
            loadIcons(); // è¼‰å…¥å…¬å‘Š
        });

        function loadIcons() {
    const sheetId = '18WW9PLenRd6MSn2pRSBKSQ2yb70CqP027hbjRZ7WjEg'; // æ›¿æ›ç‚ºæ‚¨çš„è©¦ç®—è¡¨ ID
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv`;

    fetch(url)
        .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
        .then(data => {
            const rows = data.split('\n').slice(1); // åˆ†å‰²è¡Œä¸¦ç§»é™¤æ¨™é¡Œè¡Œ
            const iconContainer = document.querySelector('.icon-container');
            iconContainer.innerHTML = ''; // æ¸…ç©ºåœ–ç¤ºå€åŸŸ

            rows.forEach(row => {
                const [imageUrl, text, link] = row.split(',').map(col => col.replace(/"/g, '').trim()); // è§£ææ¯ä¸€è¡Œ

                if (imageUrl && text && link) {
                    const icon = document.createElement('div');
                    icon.classList.add('icon');

                    icon.innerHTML = `
                        <a href="${link}" target="_blank">
                            <img src="${imageUrl}" alt="${text}">
                            <div class="icon-text">${text}</div>
                        </a>
                    `;
                    iconContainer.appendChild(icon);
                }
            });
        })
        .catch(error => console.error('Error loading icons:', error));
}

        function loadAnnouncements() {
        const sheetId = '1QTkdwcjEfqNMiKVJ6-6yrygEfiZyEOfnROfXprIafVM'; // è©¦ç®—è¡¨ ID
        const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv`;

        fetch(url)
        .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
        .then(data => {
            const rows = data.split('\n').slice(1); // åˆ†å‰²è¡Œä¸¦ç§»é™¤æ¨™é¡Œè¡Œ
            const announcementList = document.getElementById('announcements-list');
            const updateTime = document.getElementById('update-time');
            announcementList.innerHTML = ''; // æ¸…ç©ºå…¬å‘Šæ¬„

            // åªé¡¯ç¤ºå‰ä¸‰å€‹å…¬å‘Š
            rows.slice(0, 3).forEach((row) => {
                const columns = row.split(',').map(col => col.replace(/"/g, '').trim());
                const newAnnouncement = document.createElement('div');
                newAnnouncement.classList.add('announcement');

                // å‡è¨­ç¬¬ä¸€åˆ—æ˜¯æ¨™é¡Œï¼Œç¬¬äºŒåˆ—æ˜¯è¨Šæ¯ï¼Œç¬¬ä¸‰åˆ—æ˜¯è¶…é€£çµ
                newAnnouncement.innerHTML = `
                    <h2 class="title"><a href="${columns[2]}" class="link">${columns[0]}</a></h2>
                    <p class="message">${columns[1]}</p>
                    <p class="updateTime">ç™¼æ–‡æ™‚é–“ï¼š${columns[3]}</p>
                `;
                announcementList.appendChild(newAnnouncement);
            });
        })
        .catch(error => {
            console.error('Error loading announcements:', error);
            alert('ç„¡æ³•è¼‰å…¥å…¬å‘Šï¼Œè«‹æŸ¥çœ‹æ§åˆ¶å°ç²å–æ›´å¤šè³‡è¨Šã€‚');
        });
    }

    document.getElementById('view-more').addEventListener('click', () => {
        window.location.href = 'saa.html'; // æ›¿æ›ç‚ºå¯¦éš›çš„ç›®æ¨™ç¶²å€
    });

    document.addEventListener('DOMContentLoaded', loadAnnouncements);

        document.addEventListener('DOMContentLoaded', function() {
            const dropdownParent = document.querySelector('.dropdown-parent');
            const dropdownToggle = dropdownParent.querySelector('.dropdown-toggle');
            const dropdownContent = dropdownParent.querySelector('.dropdown-content');
            
            dropdownToggle.addEventListener('click', function() {
                dropdownParent.classList.toggle('active');
            });
        });

    </script>

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-messaging-compat.js"></script>
<script>
    // åˆå§‹åŒ– Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyDisL-GjghNaUWsDItEjqudlV0G2n_X2YE",
      authDomain: "scusa-85b13.firebaseapp.com",
      projectId: "scusa-85b13",
      storageBucket: "scusa-85b13.firebasestorage.app",
      messagingSenderId: "1050587816495",
      appId: "1:1050587816495:web:d2410e92470dc05d3edcda",
      measurementId: "G-XPP606Y64S"
    };
  
    firebase.initializeApp(firebaseConfig);
    const messaging = firebase.messaging();
  
    // å•Ÿå‹•é€šçŸ¥è«‹æ±‚
    Notification.requestPermission().then(permission => {
      if (permission === 'granted') {
        console.log('âœ… ç”¨æˆ¶åŒæ„æ¥æ”¶é€šçŸ¥');
  
        navigator.serviceWorker.register('/firebase-messaging-sw.js')
          .then((registration) => {
            // è¨­å®š Service Worker ä¸¦è™•ç†èƒŒæ™¯é€šçŸ¥
            messaging.setBackgroundMessageHandler(function(payload) {
              console.log('âœ… èƒŒæ™¯é€šçŸ¥æ¥æ”¶:', payload);
              // å¯ä»¥è‡ªå®šç¾©é¡¯ç¤ºé€šçŸ¥ç­‰æ“ä½œ
            });
  
            messaging.getToken({
              vapidKey: 'BCw5EjKtOV3A1GQz8F8AZc_k4oZ9gMwNrrBqtP4c3zYX-j5rD7tA-S5-rHmbZ3aXJ2UN0h0k_MuJhjpRA5lm9lM'
            }).then((currentToken) => {
              if (currentToken) {
                console.log('ğŸ“± æ¨æ’­ Token:', currentToken);
                // TODO: å¯ä»¥é€åˆ° Google Sheet å­˜ä¸‹ä¾†
              } else {
                console.warn('âš ï¸ ç„¡æ³•å–å¾—æ¨æ’­ Token');
              }
            }).catch((err) => {
              console.error('âŒ Token éŒ¯èª¤:', err);
            });
          })
          .catch((err) => {
            console.error('âŒ Service Worker è¨»å†Šå¤±æ•—:', err);
          });
      } else {
        console.warn('âŒ ç”¨æˆ¶æ‹’çµ•é€šçŸ¥æ¬Šé™');
      }
    });
  </script>
  

</body>
</html>