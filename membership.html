<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>關於我們 - 東吳大學學生會</title>
    <link rel="stylesheet" href="style_phone.css">
    <link rel="stylesheet" href="menu.css">
    <link rel="icon" href="favicon.PNG" type="image/x-icon">
</head>

<style>

/* 基本設定 */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: Arial, sans-serif;
}

/* 中心置中的容器 */
.button-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

/* 精美互動按鈕 */
.auth-button {
    padding: 15px 30px;
    font-size: 1.2em;
    color: #fff;
    background-color: #00c300;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: background-color 0.3s ease;
}

.auth-button::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 300%;
    height: 300%;
    background-color: rgba(255, 255, 255, 0.5);
    border-radius: 50%;
    transition: transform 0.5s ease;
    transform: translate(-50%, -50%) scale(0);
    pointer-events: none;
}

.auth-button:hover {
    background-color: #00a500;
}

.auth-button:active::before {
    transform: translate(-50%, -50%) scale(1);
}

.auth-button:active {
    background-color: #009000;
}


</style>
<body>
    <div class="container">
        <!-- 漢堡選單按鈕 -->
        <div class="hamburger-menu" id="hamburger-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <img src="logo.png" alt="Logo">
                <div class="site-name"></div>
            </div>

            <ul class="nav-links">
                <li>
                    <div class="main-menu" data-target="#submenu-1">東吳大學學生會</div>
                    <ul class="submenu" id="submenu-1">
                        <li><a href="東吳大學學生會main_phone.html">首頁</a></li>
                        <li><a href="東吳大學學生會introduction_phone.html">本會簡介</a></li>
                        <li><a href="東吳大學學生會financial-report_phone.html">財務報告</a></li>
                        <li><a href="東吳大學學生會about_phone.html">組織架構</a></li>
                        <li><a href="東吳大學學生會regulations_phone.html">法規彙編</a></li>
                        <li><a href="東吳大學學生會反映表單－公開phone.html">我要反映</a></li> 
                    </ul>
                </li>
                <li>
                    <div class="main-menu" data-target="#submenu-2">活動專區</div>
                    <ul class="submenu" id="submenu-2">
                        <li><a href="東吳大學學生會shop.html">特約商店</a></li>
                    </ul>
                </li>
                <li>
                    <div class="main-menu" data-target="#submenu-3">學生議會</div>
                    <ul class="submenu" id="submenu-3">
                        <li><a href="東吳大學學生議會_phone.html">東吳大學學生議會</a></li>
                        <li><a href="東吳大學學生議會－會議資料_phone.html">東吳大學學生議會－會議資料</a></li>
                        <li><a href="東吳大學學生議會－議員對照表_phone.html">東吳大學學生議會－議員對照表</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    <div>

        <div class="button-container">
            <button class="auth-button" onclick="redirectToLINE()">
                登入 LINE
            </button>
        </div>
    </div>
    <!-- JavaScript -->
    <script>



function redirectToLINE() {
    const lineAuthURL = "https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=2006561396&redirect_uri=https://scusa.netlify.app/membership.html&state=paopao5678&scope=profile%20openid";
    window.location.href = lineAuthURL;
}



// 從 URL 中提取授權碼
function getUrlParameter(name) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(name);
}

const authorizationCode = getUrlParameter('code');

if (authorizationCode) {
    // 用授權碼請求使用者資料
    getLineUserInfo(authorizationCode);
}

// 使用授權碼來請求 LINE 使用者資訊
function getLineUserInfo(code) {
    const clientId = "2006561396";  // 你的 Channel ID
    const clientSecret = "YOUR_CHANNEL_SECRET";  // 你的 Channel Secret
    const redirectUri = "https://scusa.netlify.app/membership.html";  // 你的回調 URI

    // 向 LINE 取得訪問令牌
    const tokenUrl = "https://api.line.me/oauth2/v2.1/token";
    const params = new URLSearchParams({
        grant_type: 'authorization_code',
        code: code,
        redirect_uri: redirectUri,
        client_id: clientId,
        client_secret: clientSecret
    });

    fetch(tokenUrl, {
        method: 'POST',
        body: params
    })
    .then(response => response.json())
    .then(data => {
        const accessToken = data.access_token;
        // 使用 accessToken 取得用戶資料
        fetchUserData(accessToken);
    })
    .catch(error => console.error('Error fetching access token:', error));
}

// 使用訪問令牌請求用戶資料
function fetchUserData(accessToken) {
    const userInfoUrl = "https://api.line.me/v2/profile";
    fetch(userInfoUrl, {
        method: 'GET',
        headers: {
            'Authorization': 'Bearer ' + accessToken
        }
    })
    .then(response => response.json())
    .then(data => {
        const userName = data.displayName;
        const userPicture = data.pictureUrl;

        // 當取得使用者資料後，自動填入 Google 表單
        fillGoogleForm(userName, userPicture);
    })
    .catch(error => console.error('Error fetching user data:', error));
}

// 自動填寫 Google 表單
function fillGoogleForm(userName, userPicture) {
    const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLSe0LThCK7D9Jcw5LhzDwhq7tyHKLlerQUJ8y74IXr28b0oxWQ/formResponse";
    const formData = new FormData();

    formData.append("entry.1048330234", userName);  // 假設這是用戶名稱對應的 Google Form 入口
    formData.append("entry.198592715", userPicture);  // 假設這是用戶圖片對應的 Google Form 入口

    fetch(formUrl, {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (response.ok) {
            console.log("資料已成功提交");
        } else {
            console.error("提交資料失敗");
        }
    })
    .catch(error => console.error('Error submitting form:', error));
}



        
// 當文檔滑入視窗時，添加 'show' 類別以觸發動畫
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        // 當元素進入視窗時
        if (entry.isIntersecting) {
            // 為該元素添加 'show' 類別以觸發動畫
            entry.target.classList.add('show');
        } else {
            // 可選：當元素不再進入視窗時，可以移除 'show' 類別
            entry.target.classList.remove('show');
        }
    });
});

// 監視所有具有 slide-up 類別的元素
document.querySelectorAll('.slide-up').forEach(element => {
    observer.observe(element);
});

// 餐包菜單和側邊欄的設定（未變更）
const hamburgerMenu = document.getElementById('hamburger-menu');
const sidebar = document.getElementById('sidebar');
const mainMenus = document.querySelectorAll('.main-menu');

        // 漢堡選單功能：顯示或隱藏側邊欄
        hamburgerMenu.addEventListener('click', function() {
            sidebar.classList.toggle('active');
        });

        // 點擊主選單顯示或隱藏副選單
        mainMenus.forEach(menu => {
            menu.addEventListener('click', function() {
                const targetSubmenu = document.querySelector(menu.getAttribute('data-target'));
                targetSubmenu.classList.toggle('show');
            });
        });
   
    
    </script>
</body>
</html>
