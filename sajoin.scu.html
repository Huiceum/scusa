<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>東吳大學學生會 公共參與覆附議</title>
    <link rel="stylesheet" href="sa.css">

    <link rel="icon" href="favicon.PNG" type="image/x-icon">
    <style>

    .proposalForm {
        width: 90%;
        margin: 50px;
    }
    .section {
      margin-bottom: 2rem;
      padding: 1rem;
      background: var(--sidebar-bg);
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      border: 2px solid var(--link-color);

    }
    .section h2 {
      margin-top: 0;
    }
    label {
      display: block;
      margin: 0.5rem 0 0.2rem;
    }
    input, textarea {
      width: 100%;
      padding: 0.5rem;
      border: 2px solid #131313;
      border-radius: 4px;
      background-color: var(--sidebar-bg);
      color: var(--text-white);
    }
    button {
    background-color: var(--link-color);
    color: var(--text-white);
    border-radius: 8px;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s, box-shadow 0.3s, transform 0.2s;
    position: relative;
    overflow: hidden;
    border: none;
    
}
#submitBtn {
    display: block;
    margin: 20px auto 0; /* 上 20px，中 auto，下 0 */
}
button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(120deg, var(--link-hover), var(--link-hover));
    transition: left 0.4s;
    z-index: 1;
}

button:hover::before {
    left: 100%;
}

button:hover {
    background-color: var(--link-hover);
    box-shadow: 0 0 10px var(--link-hover);
    transform: scale(1.05);
}

button:active {
    background-color: var(--link-hover);
    box-shadow: 0 0 5px var(--link-hover) inset;
    transform: scale(0.95);
}

    /* 設計提示框樣式 */
    #x0xconsent-box {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.7); /* 深色透明背景 */
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      color: #fff;
      font-family: 'Arial', sans-serif;
    }
    .x0xconsent-content {
  background-color: #fff;
  color: #333;
  padding: 30px;
  padding-left: 50px;
  border-radius: 12px;
  width: 70%;
  max-width: 60%;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
  overflow-y: auto; /* ✅ 已有 */
  max-height: 80vh; /* ✅ 加上這一行，限制最大高度為視窗高度的 80% */
  text-align: left;
}

@media screen and (max-width: 768px) {
    .x0xconsent-content {
  background-color: #fff;
  color: #333;
  padding: 30px;
  padding-left: 50px;
  border-radius: 12px;
  width: 90%;
  max-width: 60%;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
  overflow-y: auto; /* ✅ 已有 */
  max-height: 80vh; /* ✅ 加上這一行，限制最大高度為視窗高度的 80% */
  text-align: left;
}
}

    .x0xconsent-content h2 {
      margin-top: 0;
      font-size: 24px;
      color: #1d3c6e;
      font-weight: bold;
    }

    .x0xconsent-content h3 {
      margin-top: 0;
      font-size: 18px;
      color: #1d3c6e;
      font-weight: bold;
    }
    .x0xconsent-content p {
      margin-bottom: 15px;
      line-height: 1.6;
      font-size: 16px;
    }
    .x0xconsent-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 20px;
    }
    .x0xconsent-footer label {
      font-size: 16px;
    }
    .x0xconsent-footer input {
      margin-right: 10px;
      transform: scale(1.2);
    }
    #x0xagree-btn {
      padding: 10px 20px;
      background-color: #1d3c6e;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    #x0xagree-btn:disabled {
      background-color: #ddd;
      cursor: not-allowed;
    }
    #x0xagree-btn:hover:not(:disabled) {
      background-color: #14508f;
    }
    #x0xmain-content {
      display: none;
      padding: 20px;
    }
    </style>
</head>

<body>
    <div class="container">
        <!-- 漢堡選單按鈕 -->
        <div class="hamburger-menu" id="hamburger-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <!-- 手機版側邊欄 -->
        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <img src="logo.png" alt="Logo">
                <div class="site-name"></div>
            </div>
            <ul class="nav-links" id="mobile-nav">
                <!-- 動態加載的導航項目將插入此處 -->
            </ul>
        </nav>

        <div class="main-content">
            <!-- 桌面版導航欄 -->
            <div class="navbar">
                <ul class="nav-options" id="nav-container">
                    <!-- 動態加載的導航項目將插入此處 -->
                </ul>


            </div>


            <div id="x0xconsent-box">
                <div class="x0xconsent-content">
                  <h2>提案須知</h2>
              
                  <h3>一、提議者資格</h3>
                  <p>凡具有東吳大學在學學生身分者，皆得就學生事務或學生權益相關議題提出建言，並可透過學校認證帳號登入公共參與平台進行提議。</p>
                  <p>平台提供提議規範與提議者資格聲明，提議者需同意遵守，以確保後續提議程序的有效性與正當性。</p>
              
                  <h3>二、提議者身分認證</h3>
                  <p>提議者需填寫姓名、學號、聯絡方式等基本資料作為聯繫依據。</p>
              
                  <h3>三、提議範圍</h3>
                  <p>提議內容以東吳大學學生會職權範圍內之學生自治、福利、活動、社團、教育環境等議題為限。</p>
                  <p>涉及學校行政單位、教務安排、師資人事等非學生會職權之事項，將由平台管理單位視情況轉介相關單位或不予受理，學生也可至 <a href="sare.html">sare.html</a> 反映學權議題。</p>
              
                  <h3>四、提議方式及原則</h3>
                  <ul>
                    <li>提議者可參考平台上既有之相似提議內容，以避免重複提案。</li>
                    <li>提議者得指名欲由學生會內部特定部門處理之單位，若不明確，平台管理單位將協助判定並有調整權責單位之權限。</li>
                    <li>提議格式須包含主題、具體內容或建議事項、預期效益與影響、資料等，應以文字表達為主。</li>
                  </ul>
              
                  <p>若提議內容有下列情形之一，平台管理單位得不予進入附議程序，並隱藏該提案：</p>
                  <ol>
                    <li>顯然不屬於學生會職權處理範圍。</li>
                    <li>涉及恐嚇、猥褻、誹謗、詐欺、辱罵、或歧視性言論（如種族、宗教、性別等）。</li>
                    <li>涉及他人隱私權、著作權或其他法律權益之侵害。</li>
                    <li>涉及法律爭議或校方正在處理之違規案件。</li>
                    <li>與政治選舉、宗教宣傳、商業推廣等無關學生自治之目的內容。</li>
                    <li>提案內容過於模糊、訴求不明、或僅涉及個人私益。</li>
                    <li>其他違反校園秩序或不符合善良風俗者。</li>
                  </ol>
              
                  <p>提議者需詳閱並確認理解前述規定後，方可正式提交提案。提案一經提交，將由平台管理單位進行資格與內容審核。</p>
              
                  <br>
                  <p>東吳大學學生會 敬上</p>
              
                  <div class="x0xconsent-footer">
                    <label>
                      <input type="checkbox" id="x0xconsent-checkbox"> 我同意以上條款
                    </label>
                    <button id="x0xagree-btn" disabled>同意</button>
                  </div>
                </div>
              </div>
              
              <div id="x0xmain-content">
                <!-- 真正的網頁內容 -->
              </div>
              

            <form id="proposalForm" class="proposalForm">
                <div class="section">
                  <h2>基本資料</h2>
                  <label>學生學號</label>
                  <input type="text" name="entry.690555303" id="studentId" readonly>
                    <label>學生真實姓名</label>
                  <input type="text" name="entry.1636242924" required>
            
                  <label>聯絡方式（若無法聯絡，請留意學校信箱收信）</label>
                  <input type="text" name="entry.1186558829" required>
            
                  <label>提案人綽號</label>
                  <input type="text" name="entry.1945998719" required>
                </div>
            
                <div class="section">
                  <h2>提案內容</h2>
                  <label>主題</label>
                  <input type="text" name="entry.480385323" required>
            
                  <label>提議內容或建議事項</label>
                  <textarea name="entry.512931816" rows="5" required></textarea>
            
                  <label>利益與影響</label>
                  <textarea name="entry.139863505" rows="5" required></textarea>
            
                  <label>代表圖（寬度 < 720px，檔案 < 2MB）</label>
                  <input type="file" id="imageInput" accept="image/*">
                </div>
            
                <input type="hidden" name="entry.491431245" id="imageUrl">
                <input type="hidden" name="entry.1897152415" id="randomCode">
                <input type="hidden" name="entry.648196585" id="userIp">
            
                <button type="submit" id="submitBtn">送出</button>
              </form>
            
            <!-- 浮動球 -->
            <div id="ball-container">
                <img id="ball" src="ball7.gif" alt="Ball">
            </div>

            <div class="footer">
                <div class="footer-content">
                    <ul class="footer-links" id="footer-links">
                        <!-- 動態加載的底部鏈接將插入此處 -->
                    </ul>
                    <div class="footer-info">
                        © 2025 東吳大學學生會 版權所有
                    </div>
                </div>
            </div>
        </div>

    </div>



    <!-- JavaScript -->
    <script src="sa.js"></script>
    <script src="sa0.js"></script>

    <script>
    document.getElementById("studentId").value = sessionStorage.getItem("user") || "";
    document.getElementById("randomCode").value = sessionStorage.getItem("randomCode") || "";

    fetch("https://api.ipify.org?format=json")
      .then(res => res.json())
      .then(data => {
        document.getElementById("userIp").value = data.ip;
      });

    function convertTextareaBreaks(text) {
      return text.replace(/\n/g, "<br>");
    }

    document.getElementById("proposalForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const form = e.target;
      const submitBtn = document.getElementById("submitBtn");
      submitBtn.disabled = true;
      
      const imageInput = document.getElementById("imageInput");
      const imageFile = imageInput.files[0];

      if (imageFile) {
        if (imageFile.size > 2 * 1024 * 1024) {
          alert("圖片檔案超過 2MB");
          submitBtn.disabled = false;
          return;
        }

        const img = new Image();
        img.onload = async () => {
          if (img.width > 720) {
            alert("圖片寬度大於 720px");
            submitBtn.disabled = false;
            return;
          }

          const formData = new FormData();
          formData.append("image", imageFile);
          formData.append("type", "file");
          formData.append("title", "代表圖");

          const response = await fetch("https://api.imgur.com/3/image", {
            method: "POST",
            headers: {
              Authorization: "Client-ID c1f80e25b01fa7c"
            },
            body: formData
          });

          const data = await response.json();
          document.getElementById("imageUrl").value = data.data.link;
          submitToGoogleForm();
        };
        const reader = new FileReader();
        reader.onload = function(e) {
          img.src = e.target.result;
        }
        reader.readAsDataURL(imageFile);
      } else {
        submitToGoogleForm();
      }

      function submitToGoogleForm() {
        submitBtn.disabled = true;
        const textarea1 = form.querySelector("textarea[name='entry.512931816']");
        const textarea2 = form.querySelector("textarea[name='entry.139863505']");
        textarea1.value = convertTextareaBreaks(textarea1.value);
        textarea2.value = convertTextareaBreaks(textarea2.value);

        const formData = new FormData(form);

        fetch("https://docs.google.com/forms/d/e/1FAIpQLSeXyPlVPtg5Ub-cCR1HzxT1OChxhPrfkTW-oVe3-M8N17qdqw/formResponse", {
        method: "POST",
        mode: "no-cors",
        body: formData
        }).then(() => {
        alert("已成功送出！");
        form.reset();
        submitBtn.disabled = false;
        window.location.href = "sajoin.html"; // 成功後跳轉頁面
        }).catch(() => {
        alert("送出失敗，請稍後再試。");
        submitBtn.disabled = false;
        });

      }
    });



    if (!sessionStorage.getItem("user") || !sessionStorage.getItem("randomCode")) {
    window.location.href = "login.html";
  }




  const consentBox = document.getElementById('x0xconsent-box');
    const mainContent = document.getElementById('x0xmain-content');
    const consentCheckbox = document.getElementById('x0xconsent-checkbox');
    const agreeBtn = document.getElementById('x0xagree-btn');

    // 每次開啟網頁都需要同意
    consentBox.style.display = 'flex';
    mainContent.style.display = 'none';

    // 當勾選同意框時，啟用同意按鈕
    consentCheckbox.addEventListener('change', () => {
      agreeBtn.disabled = !consentCheckbox.checked;
    });

    // 當按下同意按鈕，隱藏同意書並顯示內容
    agreeBtn.addEventListener('click', () => {
      consentBox.style.display = 'none';
      mainContent.style.display = 'block';
    });

    </script>
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script src="onesignal.js" defer></script>
</body>
</html>