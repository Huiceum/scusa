<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ±å³å¤§å­¸é¸èˆ‰äº‹å‹™å§”å“¡æœƒ</title>
    <link rel="stylesheet" href="styleé¸èˆ‰_phone.css">
    <link rel="icon" href="" type="image/x-icon">

    <style>
        .form-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
        }

        .forms-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .form-card {
            background: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
            border: 1px solid #eaeaea;
        }

        .form-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
        }

        .form-header {
            background: rgb(224, 227, 230);
            color: rgb(0, 0, 0);
            padding: 15px 20px;
        }

        .form-title {
            font-size: 20px;
            font-weight: bold;
            margin: 0;
        }

        .form-content {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .form-detail {
            font-size: 14px;
            color: rgb(171, 179, 191);
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .form-detail h2 {
            font-size: 18px;
            color: rgb(255, 0, 0);
            font-weight: bold;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .deadline {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            color: #a20808;
            font-weight: bold;
        }

        .deadline-icon {
            margin-right: 5px;
        }

        .eligibility {
            margin-bottom: 20px;
            color: #333;
        }

        .countdown {
            text-align: center;
            font-size: 14px;
            margin-top: 10px;
            color: #272727;
            font-weight: bold;
        }

        .form-button {
            display: block;
            background: #272727;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 0;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            text-decoration: none;
            cursor: pointer;
            transition: background 0.3s ease;
            margin-top: auto;
            width: 100%;
        }

        .form-button:hover {
            background: #000000;
        }

        .empty-state {
            background: #f9f9f9;
            border-radius: 10px;
            padding: 40px 20px;
            text-align: center;
            color: #7f8c8d;
            font-size: 18px;
            margin-top: 20px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.03);
            border: 1px solid #eaeaea;
        }

        .empty-icon {
            font-size: 50px;
            margin-bottom: 15px;
            color: #bdc3c7;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

/* åœ¨ä¸­å¤§è¢å¹•ä¸Šå±…ä¸­é¡¯ç¤ºå–®ç­†è¡¨å–® */
@media (min-width: 601px) {
    .single-form {
        grid-template-columns: minmax(0, 400px) !important;
        justify-content: center;
    }

    .double-forms {
        grid-template-columns: repeat(2, minmax(0, 400px)) !important;
        justify-content: center;
    }
}

/* ä¿ç•™åŸæœ¬çš„éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 900px) {
    .forms-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 600px) {
    .forms-grid {
        grid-template-columns: 1fr;
    }
}
        












        /* é è¨­é€£çµæ¨£å¼ */
        a {
            color: rgb(0, 65, 97);
            text-decoration: none;
        }

        /* æ»‘é¼ æ‡¸åœæ™‚çš„æ¨£å¼ */
        a:hover {
            color: rgb(255, 255, 255);
            text-decoration: underline;
        }
        .updateTime {
        bottom: 10px;
        font-size: 0.8em;
        color: #434553;
        
    }


        .calendar {
            width: 100%;
            padding: 20px;
            background-color: rgb(255, 255, 255);
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            color: #1f1f1f;
            margin-bottom: 10px;

        }

        .events {
            width: 100%;
            padding: 20px;
            background-color: rgb(255, 255, 255);
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            height: 200px;
            margin-bottom: 80px;

        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .nothing {

            height: 100px;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            text-align: center;
        }

        .calendar-day {
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .calendar-day:hover {
            background-color: #ffffff;
        }

        .highlight {
            background-color: #212121;
            color: rgb(227, 170, 0);
        }
        
        .events h2 {
            color: #2b2b2b;
        }

        .event-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .event-item {
            padding: 10px;
            margin: 5px 0;
            background-color: #2b2b2b;
            border-radius: 5px;
            color:rgb(255, 255, 255);
        }

        .event-item a {
            color: #c6a200;
            text-decoration: none;
        }

        .event-item a:hover {
            text-decoration: underline;
        }

        .hidden {
            display: none;
        }

        .weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .weekday {
            padding: 5px;
            background-color: #d8d8d8;
        }
        .view-more-btn {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        background-color: #2b2b2b;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .view-more-btn:hover {
        background-color: #000000;
    }



/* æŒ‰éˆ•æ¨£å¼ */
button {
    background-color: #1f1f1f;
    color: #f0f0f0;
    border: 2px solid #444;
    border-radius: 8px;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s, box-shadow 0.3s, transform 0.2s;
    position: relative;
    overflow: hidden;
}

button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(120deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0));
    transition: left 0.4s;
    z-index: 1;
}

button:hover::before {
    left: 100%;
}

button:hover {
    background-color: #333;
    box-shadow: 0 0 10px #666;
    transform: scale(1.05);
}

button:active {
    background-color: #555;
    box-shadow: 0 0 5px #444 inset;
    transform: scale(0.95);
}

/* æœˆä»½èˆ‡å¹´ä»½æ–‡å­—æ¨£å¼ */
#monthYear {
    font-size: 18px;
    font-weight: bold;
    padding: 0 15px;
    color: #d0d0d0;
    text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
    transition: color 0.3s, text-shadow 0.3s;
}

#monthYear:hover {
    color: #f0f0f0;
    text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
}

    </style>
</head>

<body>

    <div class="container">
        <!-- æ¼¢å ¡é¸å–®æŒ‰éˆ• -->
        <div class="hamburger-menu" id="hamburger-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <div class="site-name"></div>
            </div>
            <ul class="nav-links slide-up">
                <li>
                    <div class="main-menu" data-target="#submenu-1">æ±å³å¤§å­¸å­¸ç”Ÿé¸èˆ‰å§”å“¡æœƒ</div>
                    <ul class="submenu" id="submenu-1">
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿé¸èˆ‰å§”å“¡æœƒ_phone.html">æ±å³å¤§å­¸å­¸ç”Ÿé¸èˆ‰å§”å“¡æœƒ</a></li>
                    </ul>
                </li>
                <li>
                    <div class="main-menu" data-target="#submenu-2">æ±å³å¤§å­¸å­¸ç”Ÿæœƒ</div>
                    <ul class="submenu" id="submenu-2">
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒmain_phone.html">é¦–é </a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒintroduction_phone.html">æœ¬æœƒç°¡ä»‹</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒfinancial-report_phone.html">è²¡å‹™å ±å‘Š</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒabout_phone.html">çµ„ç¹”æ¶æ§‹</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒregulations_phone.html">æ³•è¦å½™ç·¨</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒåæ˜ è¡¨å–®ï¼å…¬é–‹phone.html">æˆ‘è¦åæ˜ </a></li> 
                    </ul>
                </li>
                <li>
                    <div class="main-menu" data-target="#submenu-3">æ´»å‹•å°ˆå€</div>
                    <ul class="submenu" id="submenu-3">
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒshop.html">ç‰¹ç´„å•†åº—</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒæœƒç”¢ç§Ÿå€Ÿphone.html">æœƒç”¢ç§Ÿå€Ÿ</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒç¤¾åœ˜äººè³‡æ–™è½‰éŠœ.html">ç¤¾å¹¹ç™»è¨˜</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿæœƒå­¸ç”Ÿè³‡æ–™è½‰éŠœ.html">ç¶²è·¯æœƒå“¡</a></li>

                    </ul>
                </li>
                <li>
                    <div class="main-menu" data-target="#submenu-4">å­¸ç”Ÿè­°æœƒ</div>
                    <ul class="submenu" id="submenu-4">
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿè­°æœƒ_phone.html">æ±å³å¤§å­¸å­¸ç”Ÿè­°æœƒ</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿè­°æœƒï¼æœƒè­°è³‡æ–™_phone.html">æ±å³å¤§å­¸å­¸ç”Ÿè­°æœƒï¼æœƒè­°è³‡æ–™</a></li>
                        <li><a href="æ±å³å¤§å­¸å­¸ç”Ÿè­°æœƒï¼è­°å“¡å°ç…§è¡¨_phone.html">æ±å³å¤§å­¸å­¸ç”Ÿè­°æœƒï¼è­°å“¡å°ç…§è¡¨</a></li>
                    </ul>
                </li>
                <li>
                    <div class="main-menu" data-target="#submenu-5">æ±å³å¤§å­¸å­¸ç”Ÿä»²è£æ³•åº­</div>
                    <ul class="submenu" id="submenu-5">
                        <li><a href="scu_studentcourt_p.html">æ±å³å¤§å­¸å­¸ç”Ÿä»²è£æ³•åº­</a></li>
                    </ul>
                </li>
            </ul>
        </nav>


        <div class="form-container">
            <div id="formsArea" class="loading">
                <p>è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...</p>
            </div>
        </div>


        
        <div class="main-content  slide-up">
            <div class="announcements slide-up">
                <div id="announcements-list">
                    <!-- å…¬å‘Šå…§å®¹å°‡è‡ªå‹•è¼‰å…¥ -->
                </div>
                <button id="view-more" class="view-more-btn">æŸ¥çœ‹æ›´å¤š</button>
            </div>
                <!-- æ›´æ–°æ™‚é–“å°‡é¡¯ç¤ºåœ¨é€™è£¡ -->
            </div>

            <div class="calendar">
                <div class="calendar-header">
                    <button id="prevMonth">Prev</button>
                    <span id="monthYear"></span>
                    <button id="nextMonth">Next</button>
                </div>
                <div class="weekdays">
                    <div class="weekday">æ—¥</div>
                    <div class="weekday">ä¸€</div>
                    <div class="weekday">äºŒ</div>
                    <div class="weekday">ä¸‰</div>
                    <div class="weekday">å››</div>
                    <div class="weekday">äº”</div>
                    <div class="weekday">å…­</div>
                </div>
                <div class="calendar-days"></div>
            </div>
    
                <div class="events">
                    <h2>é¸å‹™æ´»å‹•</h2>
                    <div id="eventsList" class="event-list"></div>
                </div>

                <div class="nothing">.</div>
        </div>
    </div>
    <div id="ball-container">
        <img id="ball" src="ball8.gif" alt="Ball">
        <button id="mobile-btn">é–‹å•Ÿé›»è…¦ç‰ˆ</button>


    
    <!-- JavaScript -->
    <script>
        const hamburgerMenu = document.getElementById('hamburger-menu');
        const sidebar = document.getElementById('sidebar');
        const mainMenus = document.querySelectorAll('.main-menu');

        // æ¼¢å ¡é¸å–®åŠŸèƒ½ï¼šé¡¯ç¤ºæˆ–éš±è—å´é‚Šæ¬„
        hamburgerMenu.addEventListener('click', function() {
            sidebar.classList.toggle('active');
        });

        // é»æ“Šä¸»é¸å–®é¡¯ç¤ºæˆ–éš±è—å‰¯é¸å–®
        mainMenus.forEach(menu => {
            menu.addEventListener('click', function() {
                const targetSubmenu = document.querySelector(menu.getAttribute('data-target'));
                targetSubmenu.classList.toggle('show');
            });
        });
        // ç•¶æ–‡æª”åŠ è¼‰å®Œæˆå¾Œçš„äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            loadAnnouncements();
        });

 
        function loadAnnouncements() {
        const sheetId = '1gqn49ZfKbBaqwe-D5VqrBJ0n37AiVK1VHp_e-DlAiNo'; // è©¦ç®—è¡¨ ID
        const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv`;

        fetch(url)
        .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
        .then(data => {
            const rows = data.split('\n').slice(1); // åˆ†å‰²è¡Œä¸¦ç§»é™¤æ¨™é¡Œè¡Œ
            const announcementList = document.getElementById('announcements-list');
            const updateTime = document.getElementById('update-time');
            announcementList.innerHTML = ''; // æ¸…ç©ºå…¬å‘Šæ¬„

            // åªé¡¯ç¤ºå‰ä¸‰å€‹å…¬å‘Š
            rows.slice(0, 3).forEach((row) => {
                const columns = row.split(',').map(col => col.replace(/"/g, '').trim());
                const newAnnouncement = document.createElement('div');
                newAnnouncement.classList.add('announcement');

                // å‡è¨­ç¬¬ä¸€åˆ—æ˜¯æ¨™é¡Œï¼Œç¬¬äºŒåˆ—æ˜¯è¨Šæ¯ï¼Œç¬¬ä¸‰åˆ—æ˜¯è¶…é€£çµ
                newAnnouncement.innerHTML = `
                    <h2 class="title"><a href="${columns[2]}" class="link">${columns[0]}</a></h2>
                    <p class="message">${columns[1]}</p>
                    <p class="updateTime">ç™¼æ–‡æ™‚é–“ï¼š${columns[3]}</p>
                `;
                announcementList.appendChild(newAnnouncement);
            });
        })
        .catch(error => {
            console.error('Error loading announcements:', error);
            alert('ç„¡æ³•è¼‰å…¥å…¬å‘Šï¼Œè«‹æŸ¥çœ‹æ§åˆ¶å°ç²å–æ›´å¤šè³‡è¨Šã€‚');
        });
    }

    document.getElementById('view-more').addEventListener('click', () => {
        window.location.href = 'scuseca_p.html'; // æ›¿æ›ç‚ºå¯¦éš›çš„ç›®æ¨™ç¶²å€
    });

    document.addEventListener('DOMContentLoaded', loadAnnouncements);

        document.addEventListener('DOMContentLoaded', function() {
            const dropdownParent = document.querySelector('.dropdown-parent');
            const dropdownToggle = dropdownParent.querySelector('.dropdown-toggle');
            const dropdownContent = dropdownParent.querySelector('.dropdown-content');
            
            dropdownToggle.addEventListener('click', function() {
                dropdownParent.classList.toggle('active');
            });
        });


        const sheetId = '1r4WC3P2OPuamjoz3vSximkd2qi43FHoyQlhbInSHOv4'; // Your Google Sheets ID
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv`;

    let currentMonth = new Date().getMonth();
    let currentYear = new Date().getFullYear();
    let eventsData = {};

    // Load events from Google Sheets
    function loadEvents() {
    fetch(url)
        .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
        .then(data => {
            const rows = data.split('\n').slice(1); // ç§»é™¤æ¨™é¡Œåˆ—ä¸¦ç²å–è³‡æ–™
            eventsData = {};  // é‡è¨­ eventsData

            rows.forEach(row => {
                const [event, date, link, location, time] = row.split(',').map(col => col.replace(/"/g, '').trim());
                if (event && date) {
                    const eventDate = new Date(date);
                    const key = `${eventDate.getFullYear()}-${eventDate.getMonth()}-${eventDate.getDate()}`;
                    if (!eventsData[key]) eventsData[key] = [];
                    eventsData[key].push({ event, link, location, time });
                }
            });
            renderCalendar();
        })
        .catch(error => console.error('Error loading events:', error));
}


    // Render calendar for the current month
    function renderCalendar() {
    const daysContainer = document.querySelector('.calendar-days');
    const monthYearElement = document.getElementById('monthYear');
    const firstDayOfMonth = new Date(currentYear, currentMonth, 1);
    const lastDayOfMonth = new Date(currentYear, currentMonth + 1, 0);

    monthYearElement.textContent = `${firstDayOfMonth.toLocaleString('zh-TW', { month: 'long' })} ${currentYear}`;

    // æ¸…ç©ºä¹‹å‰çš„å…§å®¹
    daysContainer.innerHTML = '';

    // æ·»åŠ ç©ºç™½çš„å‰ç½®æ ¼
    for (let i = 0; i < firstDayOfMonth.getDay(); i++) {
        const emptyCell = document.createElement('div');
        daysContainer.appendChild(emptyCell);
    }

    // æ·»åŠ æ—¥æœŸæ ¼
    for (let day = 1; day <= lastDayOfMonth.getDate(); day++) {
        const dayCell = document.createElement('div');
        const dateKey = `${currentYear}-${currentMonth}-${day}`;
        dayCell.classList.add('calendar-day');
        dayCell.textContent = day;

        // æ¨™è¨»æœ‰è¡Œç¨‹çš„æ—¥æœŸ
        if (eventsData[dateKey]) {
            dayCell.classList.add('highlight');
        }

        // æ‰€æœ‰æ—¥æœŸéƒ½æ·»åŠ é»æ“Šäº‹ä»¶
        dayCell.addEventListener('click', () => showEvents(dateKey));

        daysContainer.appendChild(dayCell);
    }
}


    // Show events for a specific date
    function showEvents(dateKey) {
    const eventsList = document.getElementById('eventsList');
    eventsList.innerHTML = ''; // ç¢ºä¿æ¸…ç©ºå…§å®¹

    const eventsForDate = eventsData[dateKey] || []; // å–å¾—è©²æ—¥æœŸçš„è¡Œç¨‹

    if (eventsForDate.length === 0) {
        // å¦‚æœæ²’æœ‰è¡Œç¨‹ï¼Œé¡¯ç¤ºã€Œæ²’æœ‰è¡Œç¨‹ã€
        const noEventMessage = document.createElement('p');
        noEventMessage.textContent = 'æ²’æœ‰è¡Œç¨‹';
        eventsList.appendChild(noEventMessage);
    } else {
        // å¦‚æœæœ‰è¡Œç¨‹ï¼Œé¡¯ç¤ºæ‰€æœ‰è¡Œç¨‹è³‡è¨Š
        eventsForDate.forEach(event => {
            const eventItem = document.createElement('div');
            eventItem.classList.add('event-item');
            eventItem.innerHTML = `
                <p><strong>æ´»å‹•åç¨±ï¼š</strong><a href="${event.link}" target="_blank">${event.event}</a></p>
                <p><strong>åœ°é»ï¼š</strong>${event.location || 'ç„¡åœ°é»è³‡æ–™'}</p>
                <p><strong>æ™‚é–“ï¼š</strong>${event.time || 'ç„¡æ™‚é–“è³‡æ–™'}</p>
            `;
            eventsList.appendChild(eventItem);
        });
    }
}



    // Navigate to the previous month
    document.getElementById('prevMonth').addEventListener('click', () => {
        currentMonth--;
        if (currentMonth < 0) {
            currentMonth = 11;
            currentYear--;
        }
        loadEvents();
    });

    // Navigate to the next month
    document.getElementById('nextMonth').addEventListener('click', () => {
        currentMonth++;
        if (currentMonth > 11) {
            currentMonth = 0;
            currentYear++;
        }
        loadEvents();
    });

    // Initialize the page
    loadEvents();


    

ball.addEventListener('click', () => {
  window.location.href = 'scusec.html';
});

document.getElementById('mobile-btn').addEventListener('click', () => {
  window.location.href = 'scusec.html';
});

                // ç•¶æ–‡æª”æ»‘å…¥è¦–çª—æ™‚ï¼Œæ·»åŠ  'show' é¡åˆ¥ä»¥è§¸ç™¼å‹•ç•«
                const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('show');
                }
            });
        });

        // ç›£è¦–æ‰€æœ‰å…·æœ‰ slide-up é¡åˆ¥çš„å…ƒç´ 
        document.querySelectorAll('.slide-up').forEach(element => {
            observer.observe(element);
        });






        document.addEventListener('DOMContentLoaded', function() {
    loadForms();
});

document.addEventListener('DOMContentLoaded', function() {
    loadForms();
    
    // ç›£è½çª—å£å¤§å°è®ŠåŒ–ï¼Œé‡æ–°èª¿æ•´å¸ƒå±€
    window.addEventListener('resize', adjustLayout);
});





document.addEventListener('DOMContentLoaded', function() {
    loadForms();
    window.addEventListener('resize', adjustLayout);
});

function loadForms() {
    const sheetId = '1f7rgg-Ti1hwpQd7Y7RfoKcGwpdPLS2UEHAJEcWB97qA';
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:csv`;

    fetch(url)
        .then(response => response.ok ? response.text() : Promise.reject('Network response was not ok'))
        .then(data => {
            const rows = data.split('\n').slice(1); // åˆ†å‰²è¡Œä¸¦ç§»é™¤æ¨™é¡Œè¡Œ
            const formsArea = document.getElementById('formsArea');
            formsArea.innerHTML = ''; // æ¸…ç©ºè¼‰å…¥è¨Šæ¯
            
            // éæ¿¾å‡ºé–‹å•Ÿä¸­çš„è¡¨å–®
            const activeForms = rows.filter(row => {
                const columns = parseCSVRow(row);
                return columns.length >= 5 && columns[4].trim().toLowerCase() === 'æ˜¯';
            });

            if (activeForms.length === 0) {
                // é¡¯ç¤ºæ²’æœ‰è¡¨å–®çš„ç‹€æ…‹
                formsArea.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“‹</div>
                        <p>ç›®å‰æ²’æœ‰é¸èˆ‰é€²è¡Œä¸­</p>
                    </div>
                `;
                return;
            }

            // å‰µå»ºè¡¨å–®ç¶²æ ¼
            const formsGrid = document.createElement('div');
            formsGrid.classList.add('forms-grid');
            formsGrid.id = 'forms-grid';
            
            activeForms.forEach(row => {
                const columns = parseCSVRow(row);
                const formName = columns[0] || '';
                const deadline = columns[1] || '';
                const eligibility = columns[2] || '';
                const formLink = columns[3] || '';
                const registrationCount = columns.length > 5 ? columns[5] : ''; // Fæ¬„ç›®å‰å ±åçµ„æ•¸
                
                // å‰µå»ºè¡¨å–®å¡ç‰‡
                const formCard = createFormCard(formName, deadline, eligibility, formLink, registrationCount);
                formsGrid.appendChild(formCard);
            });
            
            formsArea.appendChild(formsGrid);
            
            // æ ¹æ“šçª—å£å¤§å°å’Œé …ç›®æ•¸é‡èª¿æ•´å¸ƒå±€
            adjustLayout();
            
            // å•Ÿå‹•å€’æ•¸è¨ˆæ™‚å™¨
            startCountdowns();
        })
        .catch(error => {
            console.error('Error loading forms:', error);
            document.getElementById('formsArea').innerHTML = `
                <div class="empty-state">
                    <div class="empty-icon">âš ï¸</div>
                    <p>è¼‰å…¥è¡¨å–®è³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤</p>
                </div>
            `;
        });
}

function adjustLayout() {
    const formsGrid = document.getElementById('forms-grid');
    if (!formsGrid) return;
    
    const windowWidth = window.innerWidth;
    const itemCount = formsGrid.children.length;
    
    // æ ¹æ“šçª—å£å¯¬åº¦è¨­ç½®å¸ƒå±€
    if (windowWidth <= 600) {
        // æ‰‹æ©Ÿç‰ˆï¼šä¸€æ’ä¸€å€‹
        formsGrid.style.gridTemplateColumns = "1fr";
    } else {
        // é›»è…¦ç‰ˆï¼šè™•ç†å°‘æ–¼ä¸‰ç­†çš„æƒ…æ³ï¼Œä½¿å…¶å±…ä¸­
        if (itemCount === 1) {
            formsGrid.style.gridTemplateColumns = "1fr";
            formsGrid.style.maxWidth = "400px";
            formsGrid.style.margin = "0 auto";
        } else if (itemCount === 2) {
            formsGrid.style.gridTemplateColumns = "1fr 1fr";
            formsGrid.style.maxWidth = "800px";
            formsGrid.style.margin = "0 auto";
        } else {
            // ä¸‰ç­†æˆ–æ›´å¤šç¶­æŒåŸæœ¬çš„å¸ƒå±€
            formsGrid.style.gridTemplateColumns = "repeat(3, 1fr)";
            formsGrid.style.maxWidth = "100%";
            formsGrid.style.margin = "0";
        }
    }
}

function parseCSVRow(row) {
    const result = [];
    let inQuotes = false;
    let currentValue = '';
    
    for (let i = 0; i < row.length; i++) {
        const char = row[i];
        
        if (char === '"') {
            inQuotes = !inQuotes;
        } else if (char === ',' && !inQuotes) {
            result.push(currentValue.trim());
            currentValue = '';
        } else {
            currentValue += char;
        }
    }
    
    // æ·»åŠ æœ€å¾Œä¸€å€‹å€¼
    result.push(currentValue.trim());
    
    return result.map(value => {
        // ç§»é™¤åŒ…è£¹çš„å¼•è™Ÿ
        if (value.startsWith('"') && value.endsWith('"')) {
            return value.substring(1, value.length - 1);
        }
        return value;
    });
}

function createFormCard(formName, deadline, eligibility, formLink, registrationCount) {
    const card = document.createElement('div');
    card.classList.add('form-card');
    
    // æº–å‚™æ¨™é¡Œå€
    let headerContent = `
        <div class="form-header">
            <h2 class="form-title">${formName}</h2>
        </div>
    `;
    
    // æº–å‚™å…§å®¹å€ï¼Œæ ¹æ“šè³‡æ–™æ˜¯å¦ç‚ºç©ºä¾†æ±ºå®šæ˜¯å¦é¡¯ç¤ºå°æ‡‰çš„å€å¡Š
    let contentHtml = '<div class="form-content">';
    
    // åªæœ‰ç•¶æˆªæ­¢æ—¥æœŸå­˜åœ¨æ™‚æ‰é¡¯ç¤º
    if (deadline && deadline.trim() !== '') {
        contentHtml += `
            <div class="deadline">
                <span class="deadline-icon"></span>
                å ±åæˆªæ­¢æ—¥ï¼š${deadline}
            </div>
            <div class="countdown" data-deadline="${deadline}">
                è¨ˆç®—å‰©é¤˜æ™‚é–“ä¸­...
            </div>
        `;
    }
    
    // åªæœ‰ç•¶è³‡æ ¼æ‘˜è¦å­˜åœ¨æ™‚æ‰é¡¯ç¤º
    if (eligibility && eligibility.trim() !== '') {
        contentHtml += `
            <div class="eligibility form-detail">
                <strong>å ±åè³‡æ ¼ï¼š</strong>${eligibility}
            </div>
        `;
    }
    
    // åªæœ‰ç•¶ç›®å‰å ±åçµ„æ•¸å­˜åœ¨æ™‚æ‰é¡¯ç¤º
    if (registrationCount && registrationCount.trim() !== '') {
        contentHtml += `
            <div class="registration-count form-detail">
                <strong>ç›®å‰å ±åçµ„æ•¸ï¼š</strong><h2>${registrationCount}</h2>
            </div>
        `;
    }
    
    // åŠ å…¥å ±åæŒ‰éˆ•
    contentHtml += `
        <a href="${formLink}" target="_blank" class="form-button">ç«‹å³å ±å</a>
    </div>`;
    
    card.innerHTML = headerContent + contentHtml;
    
    return card;
}

function startCountdowns() {
    const countdownElements = document.querySelectorAll('.countdown');
    
    countdownElements.forEach(element => {
        const deadline = element.getAttribute('data-deadline');
        updateCountdown(element, deadline);
        
        // æ¯å°æ™‚æ›´æ–°ä¸€æ¬¡å€’æ•¸
        setInterval(() => {
            updateCountdown(element, deadline);
        }, 1000 * 60 * 60); // æ¯å°æ™‚æ›´æ–°
    });
}

function updateCountdown(element, deadlineStr) {
    // è§£ææˆªæ­¢æ—¥æœŸ (å‡è¨­æ ¼å¼ç‚º YYYY-MM-DD æˆ– YYYY/MM/DD)
    const deadlineParts = deadlineStr.split(/[-\/]/);
    
    if (deadlineParts.length !== 3) {
        element.textContent = 'æ—¥æœŸæ ¼å¼éŒ¯èª¤';
        return;
    }
    
    const year = parseInt(deadlineParts[0], 10);
    const month = parseInt(deadlineParts[1], 10) - 1; // æœˆä»½å¾0é–‹å§‹
    const day = parseInt(deadlineParts[2], 10);
    
    const deadlineDate = new Date(year, month, day, 23, 59, 59);
    const currentDate = new Date();
    
    // è¨ˆç®—å‰©é¤˜å¤©æ•¸
    const timeDifference = deadlineDate.getTime() - currentDate.getTime();
    const daysRemaining = Math.ceil(timeDifference / (1000 * 60 * 60 * 24));
    
    if (daysRemaining < 0) {
        element.textContent = 'å ±åå·²æˆªæ­¢';
        element.style.color = '#9e9e9e';
    } else if (daysRemaining === 0) {
        element.textContent = 'ä»Šå¤©æˆªæ­¢ï¼';
        element.style.color = '#f44336';
    } else {
        element.textContent = `è·é›¢æˆªæ­¢é‚„å‰© ${daysRemaining} å¤©`;
    }
}
    </script>
</body>
</html>
