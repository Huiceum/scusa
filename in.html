<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>東吳大學電子化校園系統－登入</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f5f5f5;
        }
        #login-container {
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            width: 300px;
        }
        #login-container h2 {
            margin-top: 0;
            text-align: center;
        }
        #login-container input[type="text"],
        #login-container input[type="password"],
        #login-container input[type="submit"] {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            box-sizing: border-box;
        }
        #login-container input[type="submit"] {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        #login-container input[type="submit"]:hover {
            background-color: #45a049;
        }
    </style>
    <script>
        function chk_login(event) {
            event.preventDefault();

            var empNo = document.forms["LOGIN"].EMPNO.value;
            var password = document.forms["LOGIN"].loginPassword.value;

            // 確保帳號和密碼都不為空
            if (empNo === "" || password === "") {
                alert("請輸入帳號、密碼！");
                return;
            }

            var USER_STATUS = document.forms["LOGIN"].USER_STATUS[1].checked ? "2" : "1";
            var frameName = "031552999";
            var style = "width=" + (screen.availWidth - 10) + ",height=" + (screen.availHeight - 20) + ",left=0,top=0,scrollbars=1,status=1,resizable=1,titlebar=no";
            var win;

            // 確保在這裡填上登入的 URL
            if (USER_STATUS === "2") {
                // 學生的登入 URL
                win = window.open("//www2.ecampus.scu.edu.tw/portal/stu/stuindex.aspx", frameName, style);
            } else {
                // 教職員的登入 URL
                win = window.open("//www2.ecampus.scu.edu.tw/portal/portal_emp.aspx", frameName, style);
            }

            // 模擬表單提交到後端
            var xhr = new ActiveXObject("Microsoft.XMLHTTP");
            xhr.open("POST", "https://www2.ecampus.scu.edu.tw/portal/index_01c1.aspx?control_type=LOGIN_MODE", true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4) {
                    if (xhr.status === 200) {
                        // 登入成功後的行為
                        alert("登入成功！");
                        win.focus(); // 聚焦到新開的窗口
                    } else {
                        // 登入失敗
                        alert("登入失敗，請檢查您的帳號或密碼！");
                    }
                }
            };
            xhr.send("EMPNO=" + encodeURIComponent(empNo) + "&loginPassword=" + encodeURIComponent(password) + "&USER_STATUS=" + USER_STATUS);
        }

        // 使用 IE 兼容的事件綁定
        window.onload = function() {
            var loginForm = document.forms["LOGIN"];
            loginForm.onsubmit = chk_login;
        };
    </script>
</head>

<body>
    <div id="login-container">
        <h2>登入系統</h2>
        <form name="LOGIN" method="post">
            <div>
                <label><input name="USER_STATUS" type="radio" value="1" checked /> 教職員</label>
                <label><input name="USER_STATUS" type="radio" value="2" /> 學生</label>
            </div>
            <input type="text" id="EMPNO" name="EMPNO" placeholder="帳號" />
            <input type="password" id="loginPassword" name="loginPassword" placeholder="密碼" />
            <input type="submit" value="登入" />
        </form>
    </div>
</body>
</html>
